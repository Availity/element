import{r as g}from"./index-BgYLq7fD.js";import{T as N}from"./index-DdiRDdA4.js";import{S as D,b as M}from"./index-DNupz-aR.js";import{j as i}from"./jsx-runtime-BTJTZTIL.js";import{a as K,b as V,c as R}from"./index-DdNunzh7.js";import{q as G}from"./index-DLKRbc4C.js";import{A as W}from"./Autocomplete-CjCKGKDI.js";import{u as B}from"./useInfiniteQuery-ee7wYcej.js";import{I as H}from"./IconButton-D_kG6RhR.js";import{C as Q}from"./CircularProgress-fcRSDrpN.js";var $=Object.defineProperty,J=Object.defineProperties,U=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,q=(e,t,r)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,a=(e,t)=>{for(var r in t||(t={}))w.call(t,r)&&q(e,r,t[r]);if(O)for(var r of O(t))A.call(t,r)&&q(e,r,t[r]);return e},p=(e,t)=>J(e,U(t)),_=(e,t)=>{var r={};for(var o in e)w.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&O)for(var o of O(e))t.indexOf(o)<0&&A.call(e,o)&&(r[o]=e[o]);return r},v=(e,t,r)=>new Promise((o,c)=>{var f=u=>{try{m(r.next(u))}catch(l){c(l)}},n=u=>{try{m(r.throw(u))}catch(l){c(l)}},m=u=>u.done?o(u.value):Promise.resolve(u.value).then(f,n);m((r=r.apply(e,t)).next())}),X=g.forwardRef((e,t)=>i.jsxs(i.Fragment,{children:[i.jsx(M,{orientation:"vertical",className:"MuiSelect-avEndAdornmentDivider"}),i.jsx(H,p(a({},e),{ref:t}))]})),Y={marginRight:".5rem"},Z=()=>i.jsx(Q,{"aria-label":"Loading",size:20,sx:Y}),k=e=>{var t=e,{FieldProps:r}=t,o=_(t,["FieldProps"]);const c={fullWidth:!0,size:"small"},f=n=>({InputProps:p(a(a({},n==null?void 0:n.InputProps),r==null?void 0:r.InputProps),{endAdornment:o.loading?i.jsxs(i.Fragment,{children:[(n==null?void 0:n.InputProps.endAdornment)||null,i.jsx(Z,{})]}):(n==null?void 0:n.InputProps.endAdornment)||null}),inputProps:p(a({},n==null?void 0:n.inputProps),{"aria-controls":(n==null?void 0:n.inputProps["aria-controls"])||""})});return i.jsx(W,a(a({renderInput:n=>i.jsx(N,a(a(a({},n),r),f(n))),popupIcon:i.jsx(D,{className:"MuiSelect-avExpandIcon"}),slotProps:{popupIndicator:{component:X}}},o),c))},ee=(e,t)=>{const[r,o]=g.useState("");return g.useEffect(()=>{const c=setTimeout(()=>{o(e)},t);return()=>{clearTimeout(c)}},[e]),r},te=e=>{var t=e,{loadOptions:r,limit:o=50,queryKey:c,ListboxProps:f,queryOptions:n,watchParams:m,debounceTimeout:u=350,FieldProps:l,onInputChange:P}=t,b=_(t,["loadOptions","limit","queryKey","ListboxProps","queryOptions","watchParams","debounceTimeout","FieldProps","onInputChange"]);const[h,x]=g.useState(""),S=s=>{var d;x(s.target.value),(d=l==null?void 0:l.InputProps)!=null&&d.onChange&&l.InputProps.onChange(s)},C=ee(h,u),{isLoading:F,isFetching:j,data:I,hasNextPage:L,fetchNextPage:T}=B(a({queryKey:[c,o,C,m],queryFn:s=>v(null,[s],function*({pageParam:d=0}){return r(d,o,C)}),staleTime:1e4,getNextPageParam:s=>s.hasMore?s.offset+o:void 0},n)),z=I!=null&&I.pages?I.pages.map(s=>s.options).flat():[],E=(s,d,y)=>{y==="clear"?x(s.target.value):y==="blur"&&x(d),P&&P(s,d,y)};return i.jsx(k,p(a({},b),{onInputChange:E,FieldProps:p(a({},l),{InputProps:p(a({},l==null?void 0:l.InputProps),{onChange:S})}),loading:j,options:z,ListboxProps:p(a({},f),{onScroll:s=>v(null,null,function*(){const d=s.currentTarget;d.scrollHeight-(d.scrollTop+d.clientHeight)<=5&&!F&&!j&&L&&T()})})}))},re=e=>v(null,null,function*(){const t=yield V.query(e);return{options:t.data.codes,hasMore:e.params.offset+e.params.limit<t.data.totalCount,offset:e.params.offset}}),oe=e=>[e.code,e.value].filter(Boolean).join(" - "),me=e=>{var t=e,{apiConfig:r={},queryOptions:o,queryKey:c="codes-autocomplete",list:f,watchParams:n}=t,m=_(t,["apiConfig","queryOptions","queryKey","list","watchParams"]);const u=(l,P,b)=>v(null,null,function*(){const h=yield re(p(a({},r),{params:p(a({},r.params),{list:f,offset:l,limit:P,q:b})}));return p(a({},h),{options:h.options})});return i.jsx(te,p(a({getOptionLabel:oe,queryKey:c,queryOptions:a({enabled:!!f},o),watchParams:a({list:f},n)},m),{loadOptions:u}))},ve=e=>v(null,null,function*(){const t=p(a({},e),{paramsSerializer:{serialize:o=>G.stringify(o,{arrayFormat:"repeat"})}}),r=yield K.getOrganizations(t);return{options:r.data.organizations,hasMore:e.params.offset+e.params.limit<r.data.totalCount,offset:e.params.offset}}),Pe=e=>e.name,he=(e,t)=>v(null,null,function*(){const r=yield R.getProviders(e,t);return{options:r.data.providers,hasMore:t.params.offset+t.params.limit<r.data.totalCount,offset:t.params.offset}}),ye=e=>e.uiDisplayName;export{k as A,me as C,te as a,Pe as b,ve as c,ye as d,he as e,re as f,oe as h};
