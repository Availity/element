{"version":3,"file":"Feedback.stories-44e7881c.js","sources":["../../../packages/feedback/src/lib/FeedbackForm.tsx","../../../packages/feedback/src/lib/FeedbackHeader.tsx","../../../packages/feedback/src/lib/Feedback.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { TextField } from '@availity/mui-textfield';\nimport { LoadingButton, Button } from '@availity/mui-button';\nimport { ToggleButtonGroup, ToggleButton } from '@availity/mui-toggle-button';\nimport { Grid, SvgIconProps, ToggleButtonProps, styled } from '@mui/material';\nimport { FaceFrownIcon, FaceNeutralIcon, FaceSmileIcon } from '@availity/mui-icon';\nimport { avRegionsApi } from '@availity/api-axios';\nimport { useForm, SubmitHandler, Controller } from 'react-hook-form';\n\ninterface Inputs {\n  feedback: string;\n  smileField: string;\n}\n\ninterface SmileButtonProps extends ToggleButtonProps {\n  disabled: boolean;\n  Icon: (props: SvgIconProps) => JSX.Element;\n  label: string;\n  value: string;\n}\n\ninterface FeedbackFormProps {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  analytics: { info: (entries: Record<string, unknown>) => any };\n  appName: string;\n  handleClose: () => void;\n  loading: boolean;\n  sent: boolean;\n  setLoading: React.Dispatch<React.SetStateAction<boolean>>;\n  setSent: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst SmileButtons = styled(ToggleButtonGroup, { name: 'AvFeedbackContainer', slot: 'SmileButtons' })({});\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst SmileButton = ({ disabled, Icon, label, value, ...props }: SmileButtonProps) => (\n  <div>\n    <ToggleButton aria-label={value} value={value} {...props} disabled={disabled}>\n      <Icon fontSize=\"large\" />\n    </ToggleButton>\n  </div>\n);\n\nexport const FeedbackForm = ({\n  analytics,\n  appName,\n  handleClose,\n  loading,\n  sent,\n  setLoading,\n  setSent,\n}: FeedbackFormProps): JSX.Element | null => {\n  const { control, handleSubmit, setValue, watch } = useForm<Inputs>();\n\n  const onSubmit: SubmitHandler<Inputs> = async ({ smileField, ...values }) => {\n    setLoading(true);\n    try {\n      const response = await avRegionsApi.getCurrentRegion();\n\n      await analytics.info({\n        surveyId: `${appName.replace(/\\s/g, '_')}_Smile_Survey`,\n        smileLocation: `${appName}`,\n        smile: `icon-${smileField}`,\n        url: window.location.href,\n        region: response.data.regions[0] && response.data.regions[0].id,\n        userAgent: window.navigator.userAgent,\n        submitTime: new Date(),\n        ...values, // Spread the form values onto the logger\n      });\n      setSent(true);\n      setLoading(false);\n    } catch {\n      setSent(false);\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (sent) {\n      setTimeout(() => {\n        handleClose();\n      }, 2000);\n    }\n  }, [sent]);\n\n  const options = [\n    {\n      Icon: FaceSmileIcon,\n      label: 'What do you like?',\n      value: 'smile',\n    },\n    {\n      Icon: FaceNeutralIcon,\n      label: 'What would you improve?',\n      value: 'meh',\n    },\n    { Icon: FaceFrownIcon, label: \"What don't you like?\", value: 'frown' },\n  ];\n\n  const getFeedbackLabel = () => {\n    const smile = watch('smileField');\n\n    const option = options.find((option) => option.value === smile);\n\n    return option?.label || 'What would you improve?';\n  };\n\n  if (!sent) {\n    return (\n      <Grid\n        component=\"form\"\n        container\n        justifyContent=\"center\"\n        onSubmit={handleSubmit(onSubmit)}\n        aria-label=\"Feedback Form\"\n        aria-describedby=\"feedback-form-header\"\n      >\n        <Controller\n          control={control}\n          name=\"smileField\"\n          render={({ field }) => {\n            return (\n              <SmileButtons\n                children={options.map((props) => (\n                  <SmileButton disabled={loading} key={props.value} {...props} />\n                ))}\n                {...field}\n                aria-labelledby=\"feedback-form-header\"\n                onChange={(event: React.MouseEvent<HTMLElement>, value: string) => {\n                  setValue(field.name, value);\n                }}\n                size=\"medium\"\n                exclusive\n              />\n            );\n          }}\n        />\n        <Controller\n          control={control}\n          name=\"feedback\"\n          render={({ field }) => (\n            <TextField\n              {...field}\n              fullWidth\n              multiline\n              minRows={3}\n              maxRows={3}\n              label={getFeedbackLabel()}\n              disabled={loading}\n            />\n          )}\n          rules={{ maxLength: 200, required: true }}\n        />\n        <Grid container direction=\"row\" marginTop=\"16px\" spacing={1}>\n          <Grid item xs={6}>\n            <Button color=\"secondary\" disabled={loading} fullWidth onClick={handleClose}>\n              Cancel\n            </Button>\n          </Grid>\n          <Grid item xs={6}>\n            <LoadingButton\n              disabled={!watch('smileField')}\n              fullWidth\n              loading={loading}\n              type=\"submit\"\n              variant=\"contained\"\n            >\n              Send Feedback\n            </LoadingButton>\n          </Grid>\n        </Grid>\n      </Grid>\n    );\n  } else {\n    return null;\n  }\n};\n","import { IconButton } from '@availity/mui-button';\nimport { CloseIcon } from '@availity/mui-icon';\nimport { Typography } from '@availity/mui-typography';\nimport { Grid } from '@mui/material';\n\ninterface FeedbackHeaderProps {\n  appName: string;\n  handleClose: () => void;\n  loading: boolean;\n  sent: boolean;\n}\n\nexport const FeedbackHeader = ({ appName, handleClose, loading, sent }: FeedbackHeaderProps): JSX.Element => {\n  return (\n    <Grid\n      alignItems=\"center\"\n      container\n      direction=\"row\"\n      marginBottom={!sent ? '8px' : '0px'}\n      justifyContent=\"space-between\"\n      flexWrap=\"nowrap\"\n    >\n      <Grid item whiteSpace=\"normal\">\n        <Typography component=\"h2\" variant=\"h5\">\n          {sent ? 'Thank you for your feedback.' : `Tell us what you think about ${appName}`}\n        </Typography>\n      </Grid>\n      <Grid item marginRight=\"-8px\">\n        <IconButton disabled={loading} title=\"Close\" onClick={handleClose}>\n          <CloseIcon />\n        </IconButton>\n      </Grid>\n    </Grid>\n  );\n};\n","import { useState } from 'react';\nimport { Popover } from '@availity/mui-popover';\nimport { Button } from '@availity/mui-button';\nimport { Container, styled } from '@mui/material';\nimport { avLogMessagesApi } from '@availity/api-axios';\nimport { FeedbackForm } from './FeedbackForm';\nimport { FeedbackHeader } from './FeedbackHeader';\n\nexport interface FeedbackProps {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  analytics?: { info: (entries: any) => any };\n  appName: string;\n}\n\nconst FeedbackContainer = styled(Container, { name: 'AvFeedbackContainer', slot: 'root' })({});\n\nexport const Feedback = ({ analytics = avLogMessagesApi, appName }: FeedbackProps): JSX.Element => {\n  const [anchorEl, setAnchorEl] = useState<HTMLElement | null>(null);\n  const [sent, setSent] = useState<boolean>(false);\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const handlePopoverOpen = (event: React.MouseEvent<HTMLElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handlePopoverClose = () => {\n    setAnchorEl(null);\n  };\n\n  const open = Boolean(anchorEl);\n\n  return (\n    <>\n      <Button onClick={handlePopoverOpen} color=\"secondary\" size=\"large\">\n        Give Feedback\n      </Button>\n      <Popover\n        anchorEl={anchorEl}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'right',\n        }}\n        sx={{ marginTop: '4px' }}\n        disableRestoreFocus\n        onClose={handlePopoverClose}\n        open={open}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'right',\n        }}\n      >\n        <FeedbackContainer>\n          <FeedbackHeader appName={appName} handleClose={handlePopoverClose} loading={loading} sent={sent} />\n          <FeedbackForm\n            analytics={analytics}\n            appName={appName}\n            handleClose={handlePopoverClose}\n            loading={loading}\n            sent={sent}\n            setLoading={setLoading}\n            setSent={setSent}\n          />\n        </FeedbackContainer>\n      </Popover>\n    </>\n  );\n};\n"],"names":["SmileButtons","styled","ToggleButtonGroup","SmileButton","disabled","Icon","label","value","props","jsx","ToggleButton","FeedbackForm","analytics","appName","handleClose","loading","sent","setLoading","setSent","control","handleSubmit","setValue","watch","useForm","onSubmit","smileField","values","response","avRegionsApi","useEffect","options","FaceSmileIcon","FaceNeutralIcon","FaceFrownIcon","getFeedbackLabel","smile","option","option2","jsxs","Grid","Controller","field","event","TextField","Button","LoadingButton","FeedbackHeader","Typography","IconButton","CloseIcon","FeedbackContainer","Container","Feedback","avLogMessagesApi","anchorEl","setAnchorEl","useState","handlePopoverOpen","handlePopoverClose","Fragment","Popover"],"mappings":"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"}