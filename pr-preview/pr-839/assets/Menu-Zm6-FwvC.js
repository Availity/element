import{r as p}from"./index-BSuoOqEd.js";import{a as $}from"./identifier-DhnHujDJ.js";import{u as q}from"./index-bqlmQ0VS.js";import{s as N,c as B,r as J}from"./styled-9znMky1q.js";import{g as Q}from"./generateUtilityClass-BtcU_pBl.js";import{g as X}from"./generateUtilityClasses-DDbjFgb8.js";import{u as O}from"./useSlot-jI6_c_PV.js";import{j}from"./jsx-runtime-D_zvdyIk.js";import{u as Y}from"./DefaultPropsProvider-B1sWsgx2.js";import{u as Z}from"./useSlotProps-BphRKsXg.js";import{a as ee,P as te}from"./Popover-BxuONtmd.js";import{u as oe}from"./useEnhancedEffect-CIAiDanS.js";import{g as re}from"./Modal-DRFlzA1R.js";import{o as se}from"./ownerWindow-HkKU3E4x.js";import{u as ne}from"./useForkRef-BIkqQIqh.js";import{L as ie}from"./List-CmPLZKsv.js";import{o as ae}from"./ownerDocument-DW-IO8s5.js";function T(t,o,r){return t===o?t.firstChild:o&&o.nextElementSibling?o.nextElementSibling:r?null:t.firstChild}function A(t,o,r){return t===o?r?t.firstChild:t.lastChild:o&&o.previousElementSibling?o.previousElementSibling:r?null:t.lastChild}function z(t,o){if(o===void 0)return!0;let r=t.innerText;return r===void 0&&(r=t.textContent),r=r.trim().toLowerCase(),r.length===0?!1:o.repeating?r[0]===o.keys[0]:r.startsWith(o.keys.join(""))}function F(t,o,r,P,m,S){let h=!1,u=m(t,o,o?r:!1);for(;u;){if(u===t.firstChild){if(h)return!1;h=!0}const c=P?!1:u.disabled||u.getAttribute("aria-disabled")==="true";if(!u.hasAttribute("tabindex")||!z(u,S)||c)u=m(t,u,r);else return u.focus(),!0}return!1}const le=p.forwardRef(function(o,r){const{actions:P,autoFocus:m=!1,autoFocusItem:S=!1,children:h,className:u,disabledItemsFocusable:c=!1,disableListWrap:y=!1,onKeyDown:g,variant:k="selectedMenu",...v}=o,f=p.useRef(null),R=p.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});oe(()=>{m&&f.current.focus()},[m]),p.useImperativeHandle(P,()=>({adjustStyleForScrollbar:(e,{direction:i})=>{const s=!f.current.style.width;if(e.clientHeight<f.current.clientHeight&&s){const b=`${re(se(e))}px`;f.current.style[i==="rtl"?"paddingLeft":"paddingRight"]=b,f.current.style.width=`calc(100% + ${b})`}return f.current}}),[]);const I=e=>{const i=f.current,s=e.key;if(e.ctrlKey||e.metaKey||e.altKey){g&&g(e);return}const w=ae(i).activeElement;if(s==="ArrowDown")e.preventDefault(),F(i,w,y,c,T);else if(s==="ArrowUp")e.preventDefault(),F(i,w,y,c,A);else if(s==="Home")e.preventDefault(),F(i,null,y,c,T);else if(s==="End")e.preventDefault(),F(i,null,y,c,A);else if(s.length===1){const a=R.current,K=s.toLowerCase(),L=performance.now();a.keys.length>0&&(L-a.lastTime>500?(a.keys=[],a.repeating=!0,a.previousKeyMatched=!0):a.repeating&&K!==a.keys[0]&&(a.repeating=!1)),a.lastTime=L,a.keys.push(K);const x=w&&!a.repeating&&z(w,a);a.previousKeyMatched&&(x||F(i,w,!1,c,T,a))?e.preventDefault():a.previousKeyMatched=!1}g&&g(e)},D=ne(f,r);let n=-1;p.Children.forEach(h,(e,i)=>{if(!p.isValidElement(e)){n===i&&(n+=1,n>=h.length&&(n=-1));return}e.props.disabled||(k==="selectedMenu"&&e.props.selected||n===-1)&&(n=i),n===i&&(e.props.disabled||e.props.muiSkipListHighlight||e.type.muiSkipListHighlight)&&(n+=1,n>=h.length&&(n=-1))});const M=p.Children.map(h,(e,i)=>{if(i===n){const s={};return S&&(s.autoFocus=!0),e.props.tabIndex===void 0&&k==="selectedMenu"&&(s.tabIndex=0),p.cloneElement(e,s)}return e});return j.jsx(ie,{role:"menu",ref:D,className:u,onKeyDown:I,tabIndex:m?0:-1,...v,children:M})});function ue(t){return Q("MuiMenu",t)}X("MuiMenu",["root","paper","list"]);const pe={vertical:"top",horizontal:"right"},ce={vertical:"top",horizontal:"left"},fe=t=>{const{classes:o}=t;return B({root:["root"],paper:["paper"],list:["list"]},ue,o)},me=N(te,{shouldForwardProp:t=>J(t)||t==="classes",name:"MuiMenu",slot:"Root"})({}),de=N(ee,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),he=N(le,{name:"MuiMenu",slot:"List"})({outline:0}),ve=p.forwardRef(function(o,r){const P=Y({props:o,name:"MuiMenu"}),{autoFocus:m=!0,children:S,className:h,disableAutoFocusItem:u=!1,MenuListProps:c={},onClose:y,open:g,PaperProps:k={},PopoverClasses:v,transitionDuration:f="auto",TransitionProps:{onEntering:R,...I}={},variant:D="selectedMenu",slots:n={},slotProps:M={},...e}=P,i=q(),s={...P,autoFocus:m,disableAutoFocusItem:u,MenuListProps:c,onEntering:R,PaperProps:k,transitionDuration:f,TransitionProps:I,variant:D},b=fe(s),w=m&&!u&&g,a=p.useRef(null),K=(l,d)=>{a.current&&a.current.adjustStyleForScrollbar(l,{direction:i?"rtl":"ltr"}),R&&R(l,d)},L=l=>{l.key==="Tab"&&(l.preventDefault(),y&&y(l,"tabKeyDown"))};let x=-1;p.Children.map(S,(l,d)=>{p.isValidElement(l)&&(l.props.disabled||(D==="selectedMenu"&&l.props.selected||x===-1)&&(x=d))});const E={slots:n,slotProps:{list:c,transition:I,paper:k,...M}},U=Z({elementType:n.root,externalSlotProps:M.root,ownerState:s,className:[b.root,h]}),[W,G]=O("paper",{className:b.paper,elementType:de,externalForwardedProps:E,shouldForwardComponentProp:!0,ownerState:s}),[V,_]=O("list",{className:$(b.list,c.className),elementType:he,shouldForwardComponentProp:!0,externalForwardedProps:E,getSlotProps:l=>({...l,onKeyDown:d=>{var H;L(d),(H=l.onKeyDown)==null||H.call(l,d)}}),ownerState:s}),C=typeof E.slotProps.transition=="function"?E.slotProps.transition(s):E.slotProps.transition;return j.jsx(me,{onClose:y,anchorOrigin:{vertical:"bottom",horizontal:i?"right":"left"},transformOrigin:i?pe:ce,slots:{root:n.root,paper:W,backdrop:n.backdrop,...n.transition&&{transition:n.transition}},slotProps:{root:U,paper:G,backdrop:typeof M.backdrop=="function"?M.backdrop(s):M.backdrop,transition:{...C,onEntering:(...l)=>{var d;K(...l),(d=C==null?void 0:C.onEntering)==null||d.call(C,...l)}}},open:g,ref:r,transitionDuration:f,ownerState:s,...e,classes:v,children:j.jsx(V,{actions:a,autoFocus:m&&(x===-1||u),autoFocusItem:w,variant:D,..._,children:S})})});export{ve as M,le as a};
