import{j as l,r as v}from"./iframe-B4F0UUz5.js";import{T as K}from"./index-C4Ylz4kS.js";import{S as G,b as W}from"./index-BqKnOEku.js";import{a as B,b as H,c as Q}from"./index-BCc8bUM0.js";import{q as U}from"./index-B3FYqRlo.js";import{A as $}from"./Autocomplete-QLRah01Z.js";import{u as J}from"./useInfiniteQuery-Cn-yriZR.js";import{I as X}from"./IconButton-CqGgnlnL.js";import{C as Y}from"./CircularProgress-PmMulKWi.js";var Z=Object.defineProperty,k=Object.defineProperties,ee=Object.getOwnPropertyDescriptors,x=Object.getOwnPropertySymbols,L=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable,S=(e,t,r)=>t in e?Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,a=(e,t)=>{for(var r in t||(t={}))L.call(t,r)&&S(e,r,t[r]);if(x)for(var r of x(t))F.call(t,r)&&S(e,r,t[r]);return e},u=(e,t)=>k(e,ee(t)),C=(e,t)=>{var r={};for(var o in e)L.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&x)for(var o of x(e))t.indexOf(o)<0&&F.call(e,o)&&(r[o]=e[o]);return r},h=(e,t,r)=>new Promise((o,c)=>{var f=d=>{try{m(r.next(d))}catch(p){c(p)}},s=d=>{try{m(r.throw(d))}catch(p){c(p)}},m=d=>d.done?o(d.value):Promise.resolve(d.value).then(f,s);m((r=r.apply(e,t)).next())}),te=v.forwardRef((e,t)=>l.jsxs(l.Fragment,{children:[l.jsx(W,{orientation:"vertical",className:"MuiSelect-avEndAdornmentDivider"}),l.jsx(X,u(a({},e),{ref:t}))]})),re={marginRight:".5rem"},oe=()=>l.jsx(Y,{"aria-label":"Loading",size:20,sx:re}),ne=e=>{var t=e,{FieldProps:r}=t,o=C(t,["FieldProps"]);const c={fullWidth:!0,size:"small"},f=s=>({InputProps:u(a(a({},s?.InputProps),r?.InputProps),{endAdornment:o.loading?l.jsxs(l.Fragment,{children:[s?.InputProps.endAdornment||null,l.jsx(oe,{})]}):s?.InputProps.endAdornment||null}),inputProps:u(a({},s?.inputProps),{"aria-controls":s?.inputProps["aria-controls"]||""})});return l.jsx($,a(a({renderInput:s=>l.jsx(K,a(a(a({},s),r),f(s))),popupIcon:l.jsx(G,{className:"MuiSelect-avExpandIcon"}),slotProps:{popupIndicator:{component:te}}},o),c))},ae=(e,t)=>{const[r,o]=v.useState("");return v.useEffect(()=>{const c=setTimeout(()=>{o(e)},t);return()=>{clearTimeout(c)}},[e]),r},se=e=>{var t=e,{loadOptions:r,limit:o=50,queryKey:c,ListboxProps:f,queryOptions:s,watchParams:m,debounceTimeout:d=350,FieldProps:p,onInputChange:y,prependOptions:g=[]}=t,P=C(t,["loadOptions","limit","queryKey","ListboxProps","queryOptions","watchParams","debounceTimeout","FieldProps","onInputChange","prependOptions"]);const[T,I]=v.useState(""),j=v.useRef(null),z=v.useCallback(n=>{j.current=n},[]),N=n=>{var i;I(n.target.value),(i=p?.InputProps)!=null&&i.onChange&&p.InputProps.onChange(n)},q=ae(T,d),{isLoading:D,isFetching:w,data:O,hasNextPage:_,fetchNextPage:R}=J(a({queryKey:[c,o,q,m],queryFn:n=>h(null,[n],function*({pageParam:i=0}){return r(i,o,q)}),staleTime:1e4,getNextPageParam:n=>n.hasMore?n.offset+o:void 0},s)),A=O?.pages?O.pages.map(n=>n.options).flat():[],V=g.length>0?[...g,...A.filter(n=>!g.some(i=>P.isOptionEqualToValue?P.isOptionEqualToValue(n,i):n===i))]:A,M=(n,i,b)=>{b==="clear"?I(n.target.value):b==="blur"&&I(i),y&&y(n,i,b)},E=n=>h(null,null,function*(){const i=n.currentTarget;i.scrollHeight-(i.scrollTop+i.clientHeight)<=5&&!D&&!w&&_&&R()});return v.useEffect(()=>{var n;_&&((n=j.current)==null||n.dispatchEvent(new UIEvent("scroll")))},[O?.pages.length,_]),l.jsx(ne,u(a({},P),{onInputChange:M,FieldProps:u(a({},p),{InputProps:u(a({},p?.InputProps),{onChange:N})}),loading:w,options:V,ListboxProps:u(a({},f),{ref:z,onScroll:E,onPointerEnter:E})}))},ie=e=>h(null,null,function*(){const t=yield H.query(e);return{options:t.data.codes,hasMore:e.params.offset+e.params.limit<t.data.totalCount,offset:e.params.offset}}),le=e=>[e.code,e.value].filter(Boolean).join(" - "),ge=e=>{var t=e,{apiConfig:r={},queryOptions:o,queryKey:c="codes-autocomplete",list:f,watchParams:s}=t,m=C(t,["apiConfig","queryOptions","queryKey","list","watchParams"]);const d=(p,y,g)=>h(null,null,function*(){const P=yield ie(u(a({},r),{params:u(a({},r.params),{list:f,offset:p,limit:y,q:g})}));return u(a({},P),{options:P.options})});return l.jsx(se,u(a({getOptionLabel:le,queryKey:c,queryOptions:a({enabled:!!f},o),watchParams:a({list:f},s)},m),{loadOptions:d}))},Oe=e=>h(null,null,function*(){const t=u(a({},e),{paramsSerializer:{serialize:o=>U.stringify(o,{arrayFormat:"repeat"})}}),r=yield B.getOrganizations(t);return{options:r.data.organizations,hasMore:e.params.offset+e.params.limit<r.data.totalCount,offset:e.params.offset}}),ye=e=>e.name,be=(e,t)=>h(null,null,function*(){const r=yield Q.getProviders(e,t);return{options:r.data.providers,hasMore:t.params.offset+t.params.limit<r.data.totalCount,offset:t.params.offset}}),xe=e=>e.uiDisplayName;export{ne as A,ge as C,se as a,ye as b,Oe as c,xe as d,be as e,ie as f,le as h};
