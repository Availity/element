import{r as g}from"./index-DcWiA9TO.js";import{T as D}from"./index-Cy29Pico.js";import{S as z,b as M}from"./index-DS2qViMa.js";import{j as p}from"./jsx-runtime-CcL-W3nW.js";import{a as V,b as R,c as B}from"./index-C5soOJ6z.js";import{A as G}from"./Autocomplete-DYfkOmMd.js";import{u as H}from"./useInfiniteQuery-BlwNwEaC.js";import{I as W}from"./IconButton-Caxu-qgA.js";import{C as Q}from"./CircularProgress-D8w9ZPs6.js";var $=Object.defineProperty,J=Object.defineProperties,U=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable,w=(e,t,o)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,a=(e,t)=>{for(var o in t||(t={}))A.call(t,o)&&w(e,o,t[o]);if(O)for(var o of O(t))L.call(t,o)&&w(e,o,t[o]);return e},i=(e,t)=>J(e,U(t)),y=(e,t)=>{var o={};for(var r in e)A.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&O)for(var r of O(e))t.indexOf(r)<0&&L.call(e,r)&&(o[r]=e[r]);return o},P=(e,t,o)=>new Promise((r,u)=>{var c=s=>{try{f(o.next(s))}catch(l){u(l)}},n=s=>{try{f(o.throw(s))}catch(l){u(l)}},f=s=>s.done?r(s.value):Promise.resolve(s.value).then(c,n);f((o=o.apply(e,t)).next())}),X=g.forwardRef((e,t)=>p.jsxs(p.Fragment,{children:[p.jsx(M,{orientation:"vertical",className:"MuiSelect-avEndAdornmentDivider"}),p.jsx(W,i(a({},e),{ref:t}))]})),Y={marginRight:".5rem"},Z=()=>p.jsx(Q,{"aria-label":"Loading",size:20,sx:Y}),k=e=>{var t=e,{FieldProps:o}=t,r=y(t,["FieldProps"]);const u={fullWidth:!0,size:"small"},c=n=>({InputProps:i(a(a({},n==null?void 0:n.InputProps),o==null?void 0:o.InputProps),{endAdornment:r.loading?p.jsxs(p.Fragment,{children:[(n==null?void 0:n.InputProps.endAdornment)||null,p.jsx(Z,{})]}):(n==null?void 0:n.InputProps.endAdornment)||null}),inputProps:i(a({},n==null?void 0:n.inputProps),{"aria-controls":(n==null?void 0:n.inputProps["aria-controls"])||""})});return p.jsx(G,a(a({renderInput:n=>p.jsx(D,a(a(a({},n),o),c(n))),popupIcon:p.jsx(z,{className:"MuiSelect-avExpandIcon"}),slotProps:{popupIndicator:{component:X}}},r),u))},ee=(e,t)=>{const[o,r]=g.useState("");return g.useEffect(()=>{const u=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(u)}},[e]),o},te=e=>e==="clear",C=e=>{var t=e,{loadOptions:o,limit:r=50,queryKey:u,ListboxProps:c,queryOptions:n,watchParams:f,debounceTimeout:s=350,FieldProps:l,onInputChange:v}=t,h=y(t,["loadOptions","limit","queryKey","ListboxProps","queryOptions","watchParams","debounceTimeout","FieldProps","onInputChange"]);const[b,I]=g.useState(""),S=d=>{var m;I(d.target.value),(m=l==null?void 0:l.InputProps)!=null&&m.onChange&&l.InputProps.onChange(d)},j=ee(b,s),{isLoading:F,isFetching:q,data:x,hasNextPage:K,fetchNextPage:T}=H(a({queryKey:[u,r,j,f],queryFn:d=>P(void 0,[d],function*({pageParam:m=0}){return o(m,r,j)}),staleTime:1e4,getNextPageParam:d=>d.hasMore?d.offset+r:!1},n)),E=x!=null&&x.pages?x.pages.map(d=>d.options).flat():[],N=(d,m,_)=>{te(_)&&I(d.target.value),v&&v(d,m,_)};return p.jsx(k,i(a({},h),{onInputChange:N,FieldProps:i(a({},l),{InputProps:i(a({},l==null?void 0:l.InputProps),{onChange:S})}),loading:q,options:E,ListboxProps:i(a({},c),{onScroll:d=>P(void 0,null,function*(){const m=d.currentTarget;m.scrollHeight-(m.scrollTop+m.clientHeight)<=5&&!F&&!q&&K&&T()})})}))},oe=e=>P(void 0,null,function*(){const t=yield V.query(e);return{options:t.data.codes,hasMore:e.params.offset+e.params.limit<t.data.totalCount,offset:e.params.offset}}),me=e=>{var t=e,{apiConfig:o={},queryOptions:r,queryKey:u="codes-autocomplete",list:c,watchParams:n}=t,f=y(t,["apiConfig","queryOptions","queryKey","list","watchParams"]);const s=(v,h,b)=>P(void 0,null,function*(){return yield oe(i(a({},o),{params:i(a({},o.params),{list:c,offset:v,limit:h,q:b})}))}),l=v=>[v.code,v.value].filter(Boolean).join(" - ");return p.jsx(C,i(a({getOptionLabel:l,queryKey:u,queryOptions:a({enabled:!!c},r),watchParams:a({list:c},n)},f),{loadOptions:s}))},re=e=>P(void 0,null,function*(){const t=yield R.getOrganizations(e);return{options:t.data.organizations,hasMore:e.params.offset+e.params.limit<t.data.totalCount,offset:e.params.offset}}),ve=e=>{var t=e,{apiConfig:o={},queryKey:r="org-autocomplete"}=t,u=y(t,["apiConfig","queryKey"]);const c=(f,s)=>P(void 0,null,function*(){return yield re(i(a({},o),{params:i(a({dropdown:!0},o.params),{offset:f,limit:s})}))}),n=f=>f.name;return p.jsx(C,i(a({getOptionLabel:n,queryKey:r},u),{loadOptions:c}))},ae=(e,t)=>P(void 0,null,function*(){const o=yield B.getProviders(e,t);return{options:o.data.providers,hasMore:t.params.offset+t.params.limit<o.data.totalCount,offset:t.params.offset}}),Pe=e=>{var t=e,{apiConfig:o={},customerId:r,queryKey:u="prov-autocomplete"}=t,c=y(t,["apiConfig","customerId","queryKey"]);const n=(s,l,v)=>P(void 0,null,function*(){return yield ae(r,i(a({},o),{params:i(a({},o.params),{offset:s,limit:l,q:v})}))}),f=s=>s.uiDisplayName;return p.jsx(C,i(a({getOptionLabel:f,queryOptions:{enabled:!!r},queryKey:u,watchParams:{customerId:r}},c),{loadOptions:n}))};export{k as A,me as C,ve as O,Pe as P,C as a};
