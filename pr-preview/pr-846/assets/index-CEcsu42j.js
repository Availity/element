import{j as l,r as y}from"./iframe-CJLLcML8.js";import{T as V}from"./index-DgcQpZaY.js";import{b as M,c as K}from"./index-kzcO1V8q.js";import{a as R,b as G,c as W}from"./index-CEu1gAoZ.js";import{q as B}from"./index-Dx9RdmXm.js";import{A as H}from"./Autocomplete-CzuinEhu.js";import{u as Q}from"./useInfiniteQuery-D6i0y-K1.js";import{I as $}from"./IconButton-BOgoFyJ3.js";import{C as J}from"./CircularProgress-RWvPhipq.js";var U=Object.defineProperty,X=Object.defineProperties,Y=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,w=(e,t,r)=>t in e?U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,a=(e,t)=>{for(var r in t||(t={}))A.call(t,r)&&w(e,r,t[r]);if(b)for(var r of b(t))S.call(t,r)&&w(e,r,t[r]);return e},u=(e,t)=>X(e,Y(t)),_=(e,t)=>{var r={};for(var o in e)A.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&b)for(var o of b(e))t.indexOf(o)<0&&S.call(e,o)&&(r[o]=e[o]);return r},P=(e,t,r)=>new Promise((o,c)=>{var f=d=>{try{m(r.next(d))}catch(p){c(p)}},n=d=>{try{m(r.throw(d))}catch(p){c(p)}},m=d=>d.done?o(d.value):Promise.resolve(d.value).then(f,n);m((r=r.apply(e,t)).next())}),Z=y.forwardRef((e,t)=>l.jsxs(l.Fragment,{children:[l.jsx(K,{orientation:"vertical",className:"MuiSelect-avEndAdornmentDivider"}),l.jsx($,u(a({},e),{ref:t}))]})),k={marginRight:".5rem"},ee=()=>l.jsx(J,{"aria-label":"Loading",size:20,sx:k}),te=e=>{var t=e,{FieldProps:r}=t,o=_(t,["FieldProps"]);const c={fullWidth:!0,size:"small"},f=n=>({InputProps:u(a(a({},n==null?void 0:n.InputProps),r==null?void 0:r.InputProps),{endAdornment:o.loading?l.jsxs(l.Fragment,{children:[(n==null?void 0:n.InputProps.endAdornment)||null,l.jsx(ee,{})]}):(n==null?void 0:n.InputProps.endAdornment)||null}),inputProps:u(a({},n==null?void 0:n.inputProps),{"aria-controls":(n==null?void 0:n.inputProps["aria-controls"])||""})});return l.jsx(H,a(a({renderInput:n=>l.jsx(V,a(a(a({},n),r),f(n))),popupIcon:l.jsx(M,{className:"MuiSelect-avExpandIcon"}),slotProps:{popupIndicator:{component:Z}}},o),c))},re=(e,t)=>{const[r,o]=y.useState("");return y.useEffect(()=>{const c=setTimeout(()=>{o(e)},t);return()=>{clearTimeout(c)}},[e]),r},oe=e=>{var t=e,{loadOptions:r,limit:o=50,queryKey:c,ListboxProps:f,queryOptions:n,watchParams:m,debounceTimeout:d=350,FieldProps:p,onInputChange:O,prependOptions:h=[]}=t,v=_(t,["loadOptions","limit","queryKey","ListboxProps","queryOptions","watchParams","debounceTimeout","FieldProps","onInputChange","prependOptions"]);const[F,x]=y.useState(""),L=s=>{var i;x(s.target.value),(i=p==null?void 0:p.InputProps)!=null&&i.onChange&&p.InputProps.onChange(s)},C=re(F,d),{isLoading:T,isFetching:j,data:I,hasNextPage:E,fetchNextPage:z}=Q(a({queryKey:[c,o,C,m],queryFn:s=>P(null,[s],function*({pageParam:i=0}){return r(i,o,C)}),staleTime:1e4,getNextPageParam:s=>s.hasMore?s.offset+o:void 0},n)),q=I!=null&&I.pages?I.pages.map(s=>s.options).flat():[],N=h.length>0?[...h,...q.filter(s=>!h.some(i=>v.isOptionEqualToValue?v.isOptionEqualToValue(s,i):s===i))]:q,D=(s,i,g)=>{g==="clear"?x(s.target.value):g==="blur"&&x(i),O&&O(s,i,g)};return l.jsx(te,u(a({},v),{onInputChange:D,FieldProps:u(a({},p),{InputProps:u(a({},p==null?void 0:p.InputProps),{onChange:L})}),loading:j,options:N,ListboxProps:u(a({},f),{onScroll:s=>P(null,null,function*(){const i=s.currentTarget;i.scrollHeight-(i.scrollTop+i.clientHeight)<=5&&!T&&!j&&E&&z()})})}))},ae=e=>P(null,null,function*(){const t=yield G.query(e);return{options:t.data.codes,hasMore:e.params.offset+e.params.limit<t.data.totalCount,offset:e.params.offset}}),ne=e=>[e.code,e.value].filter(Boolean).join(" - "),ve=e=>{var t=e,{apiConfig:r={},queryOptions:o,queryKey:c="codes-autocomplete",list:f,watchParams:n}=t,m=_(t,["apiConfig","queryOptions","queryKey","list","watchParams"]);const d=(p,O,h)=>P(null,null,function*(){const v=yield ae(u(a({},r),{params:u(a({},r.params),{list:f,offset:p,limit:O,q:h})}));return u(a({},v),{options:v.options})});return l.jsx(oe,u(a({getOptionLabel:ne,queryKey:c,queryOptions:a({enabled:!!f},o),watchParams:a({list:f},n)},m),{loadOptions:d}))},Pe=e=>P(null,null,function*(){const t=u(a({},e),{paramsSerializer:{serialize:o=>B.stringify(o,{arrayFormat:"repeat"})}}),r=yield R.getOrganizations(t);return{options:r.data.organizations,hasMore:e.params.offset+e.params.limit<r.data.totalCount,offset:e.params.offset}}),he=e=>e.name,Oe=(e,t)=>P(null,null,function*(){const r=yield W.getProviders(e,t);return{options:r.data.providers,hasMore:t.params.offset+t.params.limit<r.data.totalCount,offset:t.params.offset}}),ge=e=>e.uiDisplayName;export{te as A,ve as C,oe as a,he as b,Pe as c,ge as d,Oe as e,ae as f,ne as h};
