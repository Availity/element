import{r as m,j as u}from"./iframe-XJ8rUARQ.js";import{i as _}from"./index-DS1ZdVNz.js";import{d as z}from"./index-D0PoHtwb.js";import{u as B}from"./useQuery-CJ2pgcyw.js";import{S as K,F as X,n as W,G as Z,u as j,f as J,H as Y,Q as $}from"./suspense-BKyLW9Hs.js";import{g as ee,Q as te}from"./queryClient-BcfS7DiY.js";import{T as re}from"./index-Vd_41PkR.js";import{h as P,q as O}from"./index-Bic9pcsq.js";import{C as ie}from"./index-CMlwWoYU.js";import{s as q}from"./styled-DH1bohWY.js";import"./preload-helper-Dp1pzeXC.js";import"./index-0JyjbUyi.js";import"./___vite-browser-external_commonjs-proxy-Bbvn4Lk3.js";import"./index-B_QiQ0h7.js";import"./_toKey-Bc2BYSdO.js";import"./useBaseQuery-C3KxfX-D.js";import"./index-DxZmSA_X.js";import"./index--DMbptHO.js";import"./infiniteQueryBehavior-B_QQvG9O.js";import"./Tooltip-CFosmsmO.js";import"./useTheme-DdE3jScQ.js";import"./memoTheme-q27Lu1jJ.js";import"./useSlot-BQnc1wiW.js";import"./mergeSlotProps-B1UYo6hf.js";import"./isHostComponent-DVu5iVWx.js";import"./useForkRef-k_WY5UDV.js";import"./generateUtilityClasses-DDbjFgb8.js";import"./generateUtilityClass-BtcU_pBl.js";import"./useTimeout-CHPWgY-X.js";import"./useControlled-XnLwGYQ0.js";import"./useEventCallback-BDPMWXz1.js";import"./getReactElementRef-CA2jWjUI.js";import"./Portal-xufODOBH.js";import"./utils-Bu5_zceD.js";import"./TransitionGroupContext-BLsjMo91.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlotProps-ClBThUbu.js";import"./isFocusVisible-B8k4qzLc.js";import"./faCircleArrowRight-B87giHcC.js";import"./faUser-meEUFR5-.js";import"./SvgIcon-gs9ZPknn.js";import"./index-CMxAEhwf.js";import"./Typography-DLCURa9h.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./Stack-DBw9MoVN.js";import"./styled-BwErFkk7.js";import"./CircularProgress-DHokMmGN.js";import"./LinearProgress-CmXbic0K.js";import"./Box-qW0uta-Y.js";class se extends K{constructor(t,r){super(),this.client=t,this.setOptions(r),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const s=this.options;this.options=this.client.defaultMutationOptions(t),X(s,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),(r=this.currentMutation)==null||r.setOptions(this.options)}onUnsubscribe(){if(!this.hasListeners()){var t;(t=this.currentMutation)==null||t.removeObserver(this)}}onMutationUpdate(t){this.updateResult();const r={listeners:!0};t.type==="success"?r.onSuccess=!0:t.type==="error"&&(r.onError=!0),this.notify(r)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,r){return this.mutateOptions=r,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof t<"u"?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const t=this.currentMutation?this.currentMutation.state:ee(),r={...t,isLoading:t.status==="loading",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=r}notify(t){W.batch(()=>{if(this.mutateOptions&&this.hasListeners()){if(t.onSuccess){var r,s,o,i;(r=(s=this.mutateOptions).onSuccess)==null||r.call(s,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(o=(i=this.mutateOptions).onSettled)==null||o.call(i,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(t.onError){var n,c,a,d;(n=(c=this.mutateOptions).onError)==null||n.call(c,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(a=(d=this.mutateOptions).onSettled)==null||a.call(d,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}t.listeners&&this.listeners.forEach(({listener:h})=>{h(this.currentResult)})})}}function oe(e,t,r){const s=Z(e,t,r),o=j({context:s.context}),[i]=m.useState(()=>new se(o,s));m.useEffect(()=>{i.setOptions(s)},[i,s]);const n=J(m.useCallback(a=>i.subscribe(W.batchCalls(a)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),c=m.useCallback((a,d)=>{i.mutate(a,d).catch(ne)},[i]);if(n.error&&Y(i.options.useErrorBoundary,[n.error]))throw n.error;return{...n,mutate:c,mutateAsync:n.mutate}}function ne(){}const ae=60,M="Gateway-AvNavigation",H={FAVORITES_UPDATE:"av:favorites:update",FAVORITES_CHANGED:"av:favorites:changed",MAX_FAVORITES:"av:favorites:maxed"},ue=e=>typeof(e==null?void 0:e.id)=="string"&&typeof(e==null?void 0:e.pos)=="number",le=e=>Array.isArray(e)?e==null?void 0:e.filter(ue):[],ce=async({favorites:e,targetFavoriteId:t},r)=>({favorites:(await z.setApplication(r,{favorites:e})).data.favorites,targetFavoriteId:t}),de=async e=>{var o,i,n;const t=await z.getApplication(e),r=(n=(i=(o=t==null?void 0:t.data)==null?void 0:o.settings)==null?void 0:i[0])==null?void 0:n.favorites;return le(r)},pe=(e,t)=>B(["favorites"],()=>de(t),{enabled:e}),ve=({onMutationStart:e},t)=>{const r=j(),{mutateAsync:s,...o}=oe(({favorites:i,targetFavoriteId:n})=>ce({favorites:i,targetFavoriteId:n},t),{onMutate(i){e==null||e(i.targetFavoriteId)},onSuccess(i){r.setQueryData(["favorites"],i.favorites)}});return{submitFavorites:s,...o}},L=(e,t)=>{t===M&&_.send({favorites:e,event:H.FAVORITES_UPDATE})},me=e=>e===M?_.send(H.MAX_FAVORITES):null,G=m.createContext(null),D=({children:e,onFavoritesChange:t,onMaxFavoritesReached:r,settingsFavorites:s,settingsStatus:o,applicationId:i=M,maxFavorites:n=ae})=>{const[c,a]=m.useState(""),d=j(),{data:h,status:x}=pe(!o,i),l=o?s:h,S=o||x,{submitFavorites:F,status:w}=ve({onMutationStart(v){a(v)}},i);m.useEffect(()=>{const f=(()=>{if(i===M){const A=_.subscribe(H.FAVORITES_CHANGED,p=>{p!=null&&p.favorites&&d.setQueryData(["favorites"],p==null?void 0:p.favorites)},{ignoreSameWindow:!1}),E=_.subscribe(H.FAVORITES_UPDATE,p=>{p!=null&&p.favorites&&d.setQueryData(["favorites"],p==null?void 0:p.favorites)},{ignoreSameWindow:!1});return()=>{A(),E()}}})();return()=>{f&&f()}},[d,i]);const b=async v=>{if(l){const f=await F({favorites:l.filter(A=>A.id!==v),targetFavoriteId:v});L(f.favorites,i),t==null||t(f.favorites)}},y=async v=>{if(!l)return!1;if(l.length>=n)return me(i),r&&typeof r=="function"&&await r(l),!1;const f=l.reduce((g,T)=>((!g||T.pos>g.pos)&&(g=T),g),null),A=f?f.pos+1:0,E=await F({favorites:[...l,{id:v,pos:A}],targetFavoriteId:v});return L(E.favorites,i),t==null||t(E.favorites),!!E.favorites.find(g=>g.id===v)};return u.jsx(G.Provider,{value:{favorites:l,queryStatus:S,mutationStatus:w,lastClickedFavoriteId:c,deleteFavorite:b,addFavorite:y},children:e})},fe=()=>{},C=e=>{const t=m.useContext(G);if(t===null)throw new Error("useFavorites must be used within a FavoritesProvider");const{favorites:r,queryStatus:s,mutationStatus:o,lastClickedFavoriteId:i,deleteFavorite:n,addFavorite:c}=t,a=i===e,d=m.useMemo(()=>!!(r==null?void 0:r.find(F=>F.id===e)),[r,e]),h=()=>d?n(e):c(e),x=s==="loading"||s==="idle"||o==="loading";let l="initLoading";return s==="loading"&&(l="initLoading"),s==="reloading"&&(l="reloading"),o==="loading"&&(l="reloading"),(s==="error"||o==="error")&&(l="error"),s==="success"&&(o==="success"||o==="idle")&&(l="success"),{isFavorited:d,status:l,isLastClickedFavorite:a,toggleFavorite:x?fe:h}};try{D.displayName="FavoritesProvider",D.__docgenInfo={description:"",displayName:"FavoritesProvider",props:{onFavoritesChange:{defaultValue:null,description:"",name:"onFavoritesChange",required:!1,type:{name:"(favorites: Favorite[]) => void"}},onMaxFavoritesReached:{defaultValue:null,description:"",name:"onMaxFavoritesReached",required:!1,type:{name:"(favorites: Favorite[]) => void"}},settingsFavorites:{defaultValue:null,description:"",name:"settingsFavorites",required:!1,type:{name:"Favorite[]"}},settingsStatus:{defaultValue:null,description:"",name:"settingsStatus",required:!1,type:{name:"StatusUnion"}},applicationId:{defaultValue:{value:"Gateway-AvNavigation"},description:"",name:"applicationId",required:!1,type:{name:"string"}},maxFavorites:{defaultValue:{value:"60"},description:"",name:"maxFavorites",required:!1,type:{name:"number"}}}}}catch{}try{C.displayName="useFavorites",C.__docgenInfo={description:"",displayName:"useFavorites",props:{}}}catch{}const he={spinner:u.jsx(ie,{"aria-hidden":!0,size:"small",loadingCaption:!1}),unknownDisabledHeart:u.jsx(O,{"aria-hidden":!0,color:"disabled"}),favoritedDisabledHeart:u.jsx(O,{"aria-hidden":!0,color:"error",opacity:"0.6"}),unfavoritedDisabledHeart:u.jsx(P,{"aria-hidden":!0,color:"disabled",opacity:"0.6"}),favoritedHeart:u.jsx(O,{"aria-hidden":!0,color:"error"}),unfavoritedHeart:u.jsx(P,{"aria-hidden":!0,color:"secondary"})},V="2.5rem",ye=q("div",{name:"AvFavoriteHeart",slot:"Root"})(({customSize:e})=>({height:e,width:e})),N=q("input",{name:"AvFavoriteHeart",slot:"input"})(({customSize:e})=>({height:e,width:e,minHeight:e,minWidth:e})),Fe=(e=V)=>{const t=e.match(/^(\d*\.?\d+)(px|rem)$/);if(!t)throw new Error("Invalid size format. Must be in 'px' or 'rem'.");const[,r,s]=t;return`${parseFloat(r)/2}${s}`},be=q("div",{name:"AvFavoriteHeart",slot:"icon"})(({customSize:e})=>({fontSize:Fe(e)})),ge=e=>{const t=e.match(/^(\d*\.?\d+)(px|rem)$/);if(!t)return!1;const[,r,s]=t,o=parseFloat(r);return s==="rem"&&o>=1.5?!0:s==="px"&&o>=24},I=({id:e,name:t,onChange:r,onMouseDown:s,disabled:o=!1,customSize:i=V})=>{const{isFavorited:n,isLastClickedFavorite:c,status:a,toggleFavorite:d}=C(e),h=y=>{r==null||r(n,y),d()},x=y=>{(y.code==="Enter"||y.key==="Enter")&&(r==null||r(n,y),d())},l=a==="initLoading"?"unknownDisabledHeart":a==="reloading"?c?"spinner":n?"favoritedDisabledHeart":"unfavoritedDisabledHeart":o?n?"favoritedDisabledHeart":"unfavoritedDisabledHeart":n?"favoritedHeart":"unfavoritedHeart",S=o||!c&&(a==="initLoading"||a==="reloading")?"not-allowed":void 0,F=`${n?"Remove from":"Add to"} My Favorites`,w={onKeyDown:x,type:"checkbox","aria-label":`Favorite ${t}`,id:`av-favorite-heart-${e}`,disabled:o,checked:n,onChange:h,onMouseDown:s,style:{cursor:S}},b=ge(i)?i:V;return u.jsxs(ye,{customSize:b,children:[u.jsx(be,{customSize:b,children:he[l]}),u.jsx("span",{style:{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},"aria-live":c&&(a==="reloading"||a==="error")?"polite":"off",children:c&&a==="reloading"?"Loading...":c&&a==="error"?"An error has occurred. Please try again.":""}),o?u.jsx(N,{customSize:b,...w}):u.jsx(re,{title:F,placement:"top",children:u.jsx(N,{customSize:b,...w})})]})};try{I.displayName="FavoriteHeart",I.__docgenInfo={description:"",displayName:"FavoriteHeart",props:{id:{defaultValue:null,description:"The configuration's id",name:"id",required:!0,type:{name:"string"}},name:{defaultValue:null,description:"The name of the configuration",name:"name",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"What to do on Favorite Toggle",name:"onChange",required:!1,type:{name:"(isFavorited: boolean, event: any) => void"}},onMouseDown:{defaultValue:null,description:"What to do on click",name:"onMouseDown",required:!1,type:{name:"(event: React.MouseEvent<HTMLInputElement, MouseEvent>) => void"}},disabled:{defaultValue:{value:"false"},description:"Whether or not the Favorite is disabled",name:"disabled",required:!1,type:{name:"boolean"}},customSize:{defaultValue:{value:"2.5rem"},description:"The size of the icon in rem or px, minimum size is 1.5rem / 24px",name:"customSize",required:!1,type:{name:"string"}}}}}catch{}const yt={title:"Components/Favorites/Favorites",component:I},xe=[{id:"123",pos:0,name:"App #1"},{id:"456",pos:0,name:"A retired app"},{id:"789",pos:0,name:"Another retired app"}],R={render:()=>u.jsx($,{client:new te({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),children:u.jsx(D,{children:xe.map(e=>u.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[u.jsx(I,{id:e.id,name:e.name,disabled:e.name.includes("retired")}),u.jsx("div",{children:e.name})]},e.id))})})};var k,Q,U;R.parameters={...R.parameters,docs:{...(k=R.parameters)==null?void 0:k.docs,source:{originalSource:`{
  render: () => {
    return <QueryClientProvider client={new QueryClient({
      defaultOptions: {
        queries: {
          refetchOnWindowFocus: false
        }
      }
    })}>
        <FavoritesProvider>
          {storyFavorites.map(fav => <div style={{
          display: 'flex',
          gap: '1rem',
          alignItems: 'center'
        }} key={fav.id}>
              <FavoriteHeart id={fav.id} name={fav.name} disabled={fav.name.includes('retired')} />
              <div>{fav.name}</div>
            </div>)}
        </FavoritesProvider>
      </QueryClientProvider>;
  }
}`,...(U=(Q=R.parameters)==null?void 0:Q.docs)==null?void 0:U.source}}};const Ft=["_FavoriteHeart"];export{R as _FavoriteHeart,Ft as __namedExportsOrder,yt as default};
