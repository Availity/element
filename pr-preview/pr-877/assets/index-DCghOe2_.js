import{ax as $e,h as Ct}from"./iframe-DV3He85V.js";var Tt=e=>{if(typeof e!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof e}\``);return/^[a-z][a-z\d+.-]*:/.test(e)},Ft=Tt;function He(e){return!e||e==="#"||e==="?"||e==="/"}function Se(e){const t=[];let r=0;for(;r<e.length;)switch(e[r]){case"/":{if(e[r+1]===".")if(e[r+2]==="."){if(!He(e[r+3])){t.at(-1).push(e.substr(r)),r=e.length;break}t.pop(),e[r+3]||t.push([]),r+=3}else{if(!He(e[r+2])){t.at(-1).push(e.substr(r)),r=e.length;break}e[r+2]||t.push([]),r+=2}else t.push([]),r+=1;break}case"#":case"?":{t.length===0&&t.push([]),t.at(-1).push(e.substr(r)),r=e.length;break}default:{t.length===0&&t.push([]),t.at(-1).push(e[r]),r+=1;break}}return`/${t.map(n=>n.join("")).join("/")}`}function G(e,t){let r=t+1;t>=0?e[t+1]==="/"&&e[t+2]==="/"&&(r=t+3):e[0]==="/"&&e[1]==="/"&&(r=2);const n=e.indexOf("/",r);if(n<0)return e;const o=e.substr(0,n),s=e.substr(n);return o+Se(s)}function Lt(e,t=""){const r=t.indexOf("#");if(r>0&&(t=t.substr(0,r)),e.length===0)return t;if(e.indexOf("?")===0){const m=t.indexOf("?");return m>0&&(t=t.substr(0,m)),t+e}if(e.indexOf("#")===0)return t+e;if(t.length===0)return G(e,e.indexOf(":"));const n=e.indexOf(":");if(n>=0)return G(e,n);const o=t.indexOf(":");if(o<0)throw new Error(`Found invalid baseIRI '${t}' for value '${e}'`);const s=t.substr(0,o+1);if(e.indexOf("//")===0)return s+G(e,n);let l;if(t.indexOf("//",o)===o+1){if(l=t.indexOf("/",o+3),l<0)return t.length>o+3?`${t}/${G(e,n)}`:s+G(e,n)}else return l=t.indexOf("/",o+1),t.length>o+1?`${t}/${G(e,n)}`:s+G(e,n);if(e.indexOf("/")===0)return t.substr(0,l)+Se(e);let c=t.substr(l);const f=c.lastIndexOf("/");return f>=0&&f<c.length-1&&(c=c.substr(0,f+1),e[0]==="."&&e[1]!=="."&&e[1]!=="/"&&e[2]&&(e=e.substr(1))),e=c+e,e=Se(e),t.substr(0,l)+e}var Dt=({relative:e="",base:t})=>{if(Ft(e))return e;if(!t){const{origin:r}=window.location;t=`${r}/`}return Lt(e,t)},$t=Dt,Ht=$t;function Pe(e){"@babel/helpers - typeof";return Pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(e)}function Nt(e,t,r){return Object.defineProperty(e,"prototype",{writable:!1}),e}function qt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zt(e,t,r){return t=oe(t),Bt(e,Ce()?Reflect.construct(t,r||[],oe(e).constructor):t.apply(e,r))}function Bt(e,t){if(t&&(Pe(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mt(e)}function Mt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}function Ue(e){var t=typeof Map=="function"?new Map:void 0;return Ue=function(n){if(n===null||!Kt(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(n))return t.get(n);t.set(n,o)}function o(){return It(n,arguments,oe(this).constructor)}return o.prototype=Object.create(n.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),ne(o,n)},Ue(e)}function It(e,t,r){if(Ce())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return r&&ne(o,r.prototype),o}function Ce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ce=function(){return!!e})()}function Kt(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function ne(e,t){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},ne(e,t)}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oe(e)}var fe=(function(e){function t(r){var n,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(qt(this,t),n=zt(this,t,[r]),n.originalRequest=s,n.originalResponse=l,n.causingError=o,o!=null&&(r+=", caused by ".concat(o.toString())),s!=null){var c=s.getHeader("X-Request-ID")||"n/a",f=s.getMethod(),m=s.getURL(),w=l?l.getStatus():"n/a",k=l?l.getBody()||"":"n/a";r+=", originated from request (method: ".concat(f,", url: ").concat(m,", response code: ").concat(w,", response text: ").concat(k,", request id: ").concat(c,")")}return n.message=r,n}return Gt(t,e),Nt(t)})(Ue(Error));function ie(e){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie(e)}function Vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yt(n.key),n)}}function Zt(e,t,r){return t&&Xt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yt(e){var t=Jt(e,"string");return ie(t)=="symbol"?t:t+""}function Jt(e,t){if(ie(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ie(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Wt=(function(){function e(){Vt(this,e)}return Zt(e,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(r){return Promise.resolve([])}},{key:"removeUpload",value:function(r){return Promise.resolve()}},{key:"addUpload",value:function(r,n){return Promise.resolve(null)}}])})();const ct="3.7.8",Qt=ct,Q=typeof Buffer=="function",Ne=typeof TextDecoder=="function"?new TextDecoder:void 0,qe=typeof TextEncoder=="function"?new TextEncoder:void 0,er="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ee=Array.prototype.slice.call(er),ce=(e=>{let t={};return e.forEach((r,n)=>t[r]=n),t})(ee),tr=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,F=String.fromCharCode.bind(String),ze=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),ht=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),pt=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),dt=e=>{let t,r,n,o,s="";const l=e.length%3;for(let c=0;c<e.length;){if((r=e.charCodeAt(c++))>255||(n=e.charCodeAt(c++))>255||(o=e.charCodeAt(c++))>255)throw new TypeError("invalid character found");t=r<<16|n<<8|o,s+=ee[t>>18&63]+ee[t>>12&63]+ee[t>>6&63]+ee[t&63]}return l?s.slice(0,l-3)+"===".substring(l):s},Te=typeof btoa=="function"?e=>btoa(e):Q?e=>Buffer.from(e,"binary").toString("base64"):dt,Oe=Q?e=>Buffer.from(e).toString("base64"):e=>{let r=[];for(let n=0,o=e.length;n<o;n+=4096)r.push(F.apply(null,e.subarray(n,n+4096)));return Te(r.join(""))},pe=(e,t=!1)=>t?ht(Oe(e)):Oe(e),rr=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?F(192|t>>>6)+F(128|t&63):F(224|t>>>12&15)+F(128|t>>>6&63)+F(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return F(240|t>>>18&7)+F(128|t>>>12&63)+F(128|t>>>6&63)+F(128|t&63)}},nr=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,yt=e=>e.replace(nr,rr),Be=Q?e=>Buffer.from(e,"utf8").toString("base64"):qe?e=>Oe(qe.encode(e)):e=>Te(yt(e)),J=(e,t=!1)=>t?ht(Be(e)):Be(e),Me=e=>J(e,!0),or=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,ir=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=t-65536;return F((r>>>10)+55296)+F((r&1023)+56320);case 3:return F((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return F((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},mt=e=>e.replace(or,ir),gt=e=>{if(e=e.replace(/\s+/g,""),!tr.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,r,n,o=[];for(let s=0;s<e.length;)t=ce[e.charAt(s++)]<<18|ce[e.charAt(s++)]<<12|(r=ce[e.charAt(s++)])<<6|(n=ce[e.charAt(s++)]),r===64?o.push(F(t>>16&255)):n===64?o.push(F(t>>16&255,t>>8&255)):o.push(F(t>>16&255,t>>8&255,t&255));return o.join("")},Fe=typeof atob=="function"?e=>atob(pt(e)):Q?e=>Buffer.from(e,"base64").toString("binary"):gt,vt=Q?e=>ze(Buffer.from(e,"base64")):e=>ze(Fe(e).split("").map(t=>t.charCodeAt(0))),bt=e=>vt(_t(e)),ar=Q?e=>Buffer.from(e,"base64").toString("utf8"):Ne?e=>Ne.decode(vt(e)):e=>mt(Fe(e)),_t=e=>pt(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),xe=e=>ar(_t(e)),sr=e=>{if(typeof e!="string")return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},wt=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),St=function(){const e=(t,r)=>Object.defineProperty(String.prototype,t,wt(r));e("fromBase64",function(){return xe(this)}),e("toBase64",function(t){return J(this,t)}),e("toBase64URI",function(){return J(this,!0)}),e("toBase64URL",function(){return J(this,!0)}),e("toUint8Array",function(){return bt(this)})},Pt=function(){const e=(t,r)=>Object.defineProperty(Uint8Array.prototype,t,wt(r));e("toBase64",function(t){return pe(this,t)}),e("toBase64URI",function(){return pe(this,!0)}),e("toBase64URL",function(){return pe(this,!0)})},ur=()=>{St(),Pt()},lr={version:ct,VERSION:Qt,atob:Fe,atobPolyfill:gt,btoa:Te,btoaPolyfill:dt,fromBase64:xe,toBase64:J,encode:J,encodeURI:Me,encodeURL:Me,utob:yt,btou:mt,decode:xe,isValid:sr,fromUint8Array:pe,toUint8Array:bt,extendString:St,extendUint8Array:Pt,extendBuiltins:ur};var ve,Ge;function fr(){return Ge||(Ge=1,ve=function(t,r){if(r=r.split(":")[0],t=+t,!t)return!1;switch(r){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0}),ve}var he={},Ie;function cr(){if(Ie)return he;Ie=1;var e=Object.prototype.hasOwnProperty,t;function r(l){try{return decodeURIComponent(l.replace(/\+/g," "))}catch{return null}}function n(l){try{return encodeURIComponent(l)}catch{return null}}function o(l){for(var c=/([^=?#&]+)=?([^&]*)/g,f={},m;m=c.exec(l);){var w=r(m[1]),k=r(m[2]);w===null||k===null||w in f||(f[w]=k)}return f}function s(l,c){c=c||"";var f=[],m,w;typeof c!="string"&&(c="?");for(w in l)if(e.call(l,w)){if(m=l[w],!m&&(m===null||m===t||isNaN(m))&&(m=""),w=n(w),m=n(m),w===null||m===null)continue;f.push(w+"="+m)}return f.length?c+f.join("&"):""}return he.stringify=s,he.parse=o,he}var be,Ke;function hr(){if(Ke)return be;Ke=1;var e=fr(),t=cr(),r=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,n=/[\n\r\t]/g,o=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,s=/:\d+$/,l=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,c=/^[a-zA-Z]:/;function f(v){return(v||"").toString().replace(r,"")}var m=[["#","hash"],["?","query"],function(g,b){return C(b.protocol)?g.replace(/\\/g,"/"):g},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],w={hash:1,query:1};function k(v){var g;typeof window<"u"?g=window:typeof $e<"u"?g=$e:typeof self<"u"?g=self:g={};var b=g.location||{};v=v||b;var d={},U=typeof v,S;if(v.protocol==="blob:")d=new A(unescape(v.pathname),{});else if(U==="string"){d=new A(v,{});for(S in w)delete d[S]}else if(U==="object"){for(S in v)S in w||(d[S]=v[S]);d.slashes===void 0&&(d.slashes=o.test(v.href))}return d}function C(v){return v==="file:"||v==="ftp:"||v==="http:"||v==="https:"||v==="ws:"||v==="wss:"}function B(v,g){v=f(v),v=v.replace(n,""),g=g||{};var b=l.exec(v),d=b[1]?b[1].toLowerCase():"",U=!!b[2],S=!!b[3],E=0,O;return U?S?(O=b[2]+b[3]+b[4],E=b[2].length+b[3].length):(O=b[2]+b[4],E=b[2].length):S?(O=b[3]+b[4],E=b[3].length):O=b[4],d==="file:"?E>=2&&(O=O.slice(2)):C(d)?O=b[4]:d?U&&(O=O.slice(2)):E>=2&&C(g.protocol)&&(O=b[4]),{protocol:d,slashes:U||C(d),slashesCount:E,rest:O}}function q(v,g){if(v==="")return g;for(var b=(g||"/").split("/").slice(0,-1).concat(v.split("/")),d=b.length,U=b[d-1],S=!1,E=0;d--;)b[d]==="."?b.splice(d,1):b[d]===".."?(b.splice(d,1),E++):E&&(d===0&&(S=!0),b.splice(d,1),E--);return S&&b.unshift(""),(U==="."||U==="..")&&b.push(""),b.join("/")}function A(v,g,b){if(v=f(v),v=v.replace(n,""),!(this instanceof A))return new A(v,g,b);var d,U,S,E,O,$,z=m.slice(),V=typeof g,_=this,N=0;for(V!=="object"&&V!=="string"&&(b=g,g=null),b&&typeof b!="function"&&(b=t.parse),g=k(g),U=B(v||"",g),d=!U.protocol&&!U.slashes,_.slashes=U.slashes||d&&g.slashes,_.protocol=U.protocol||g.protocol||"",v=U.rest,(U.protocol==="file:"&&(U.slashesCount!==2||c.test(v))||!U.slashes&&(U.protocol||U.slashesCount<2||!C(_.protocol)))&&(z[3]=[/(.*)/,"pathname"]);N<z.length;N++){if(E=z[N],typeof E=="function"){v=E(v,_);continue}S=E[0],$=E[1],S!==S?_[$]=v:typeof S=="string"?(O=S==="@"?v.lastIndexOf(S):v.indexOf(S),~O&&(typeof E[2]=="number"?(_[$]=v.slice(0,O),v=v.slice(O+E[2])):(_[$]=v.slice(O),v=v.slice(0,O)))):(O=S.exec(v))&&(_[$]=O[1],v=v.slice(0,O.index)),_[$]=_[$]||d&&E[3]&&g[$]||"",E[4]&&(_[$]=_[$].toLowerCase())}b&&(_.query=b(_.query)),d&&g.slashes&&_.pathname.charAt(0)!=="/"&&(_.pathname!==""||g.pathname!=="")&&(_.pathname=q(_.pathname,g.pathname)),_.pathname.charAt(0)!=="/"&&C(_.protocol)&&(_.pathname="/"+_.pathname),e(_.port,_.protocol)||(_.host=_.hostname,_.port=""),_.username=_.password="",_.auth&&(O=_.auth.indexOf(":"),~O?(_.username=_.auth.slice(0,O),_.username=encodeURIComponent(decodeURIComponent(_.username)),_.password=_.auth.slice(O+1),_.password=encodeURIComponent(decodeURIComponent(_.password))):_.username=encodeURIComponent(decodeURIComponent(_.auth)),_.auth=_.password?_.username+":"+_.password:_.username),_.origin=_.protocol!=="file:"&&C(_.protocol)&&_.host?_.protocol+"//"+_.host:"null",_.href=_.toString()}function R(v,g,b){var d=this;switch(v){case"query":typeof g=="string"&&g.length&&(g=(b||t.parse)(g)),d[v]=g;break;case"port":d[v]=g,e(g,d.protocol)?g&&(d.host=d.hostname+":"+g):(d.host=d.hostname,d[v]="");break;case"hostname":d[v]=g,d.port&&(g+=":"+d.port),d.host=g;break;case"host":d[v]=g,s.test(g)?(g=g.split(":"),d.port=g.pop(),d.hostname=g.join(":")):(d.hostname=g,d.port="");break;case"protocol":d.protocol=g.toLowerCase(),d.slashes=!b;break;case"pathname":case"hash":if(g){var U=v==="pathname"?"/":"#";d[v]=g.charAt(0)!==U?U+g:g}else d[v]=g;break;case"username":case"password":d[v]=encodeURIComponent(g);break;case"auth":var S=g.indexOf(":");~S?(d.username=g.slice(0,S),d.username=encodeURIComponent(decodeURIComponent(d.username)),d.password=g.slice(S+1),d.password=encodeURIComponent(decodeURIComponent(d.password))):d.username=encodeURIComponent(decodeURIComponent(g))}for(var E=0;E<m.length;E++){var O=m[E];O[4]&&(d[O[1]]=d[O[1]].toLowerCase())}return d.auth=d.password?d.username+":"+d.password:d.username,d.origin=d.protocol!=="file:"&&C(d.protocol)&&d.host?d.protocol+"//"+d.host:"null",d.href=d.toString(),d}function H(v){(!v||typeof v!="function")&&(v=t.stringify);var g,b=this,d=b.host,U=b.protocol;U&&U.charAt(U.length-1)!==":"&&(U+=":");var S=U+(b.protocol&&b.slashes||C(b.protocol)?"//":"");return b.username?(S+=b.username,b.password&&(S+=":"+b.password),S+="@"):b.password?(S+=":"+b.password,S+="@"):b.protocol!=="file:"&&C(b.protocol)&&!d&&b.pathname!=="/"&&(S+="@"),(d[d.length-1]===":"||s.test(b.hostname)&&!b.port)&&(d+=":"),S+=d+b.pathname,g=typeof b.query=="object"?v(b.query):b.query,g&&(S+=g.charAt(0)!=="?"?"?"+g:g),b.hash&&(S+=b.hash),S}return A.prototype={set:R,toString:H},A.extractProtocol=B,A.location=k,A.trimLeft=f,A.qs=t,be=A,be}var pr=hr();const dr=Ct(pr);function yr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,r=e==="x"?t:t&3|8;return r.toString(16)})}function Ee(){Ee=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(u,i,a){u[i]=a.value},s=typeof Symbol=="function"?Symbol:{},l=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",f=s.toStringTag||"@@toStringTag";function m(u,i,a){return Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}),u[i]}try{m({},"")}catch{m=function(a,h,y){return a[h]=y}}function w(u,i,a,h){var y=i&&i.prototype instanceof H?i:H,p=Object.create(y.prototype),P=new N(h||[]);return o(p,"_invoke",{value:$(u,a,P)}),p}function k(u,i,a){try{return{type:"normal",arg:u.call(i,a)}}catch(h){return{type:"throw",arg:h}}}t.wrap=w;var C="suspendedStart",B="suspendedYield",q="executing",A="completed",R={};function H(){}function v(){}function g(){}var b={};m(b,l,function(){return this});var d=Object.getPrototypeOf,U=d&&d(d(M([])));U&&U!==r&&n.call(U,l)&&(b=U);var S=g.prototype=H.prototype=Object.create(b);function E(u){["next","throw","return"].forEach(function(i){m(u,i,function(a){return this._invoke(i,a)})})}function O(u,i){function a(y,p,P,x){var j=k(u[y],u,p);if(j.type!=="throw"){var L=j.arg,T=L.value;return T&&I(T)=="object"&&n.call(T,"__await")?i.resolve(T.__await).then(function(D){a("next",D,P,x)},function(D){a("throw",D,P,x)}):i.resolve(T).then(function(D){L.value=D,P(L)},function(D){return a("throw",D,P,x)})}x(j.arg)}var h;o(this,"_invoke",{value:function(p,P){function x(){return new i(function(j,L){a(p,P,j,L)})}return h=h?h.then(x,x):x()}})}function $(u,i,a){var h=C;return function(y,p){if(h===q)throw Error("Generator is already running");if(h===A){if(y==="throw")throw p;return{value:e,done:!0}}for(a.method=y,a.arg=p;;){var P=a.delegate;if(P){var x=z(P,a);if(x){if(x===R)continue;return x}}if(a.method==="next")a.sent=a._sent=a.arg;else if(a.method==="throw"){if(h===C)throw h=A,a.arg;a.dispatchException(a.arg)}else a.method==="return"&&a.abrupt("return",a.arg);h=q;var j=k(u,i,a);if(j.type==="normal"){if(h=a.done?A:B,j.arg===R)continue;return{value:j.arg,done:a.done}}j.type==="throw"&&(h=A,a.method="throw",a.arg=j.arg)}}}function z(u,i){var a=i.method,h=u.iterator[a];if(h===e)return i.delegate=null,a==="throw"&&u.iterator.return&&(i.method="return",i.arg=e,z(u,i),i.method==="throw")||a!=="return"&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+a+"' method")),R;var y=k(h,u.iterator,i.arg);if(y.type==="throw")return i.method="throw",i.arg=y.arg,i.delegate=null,R;var p=y.arg;return p?p.done?(i[u.resultName]=p.value,i.next=u.nextLoc,i.method!=="return"&&(i.method="next",i.arg=e),i.delegate=null,R):p:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,R)}function V(u){var i={tryLoc:u[0]};1 in u&&(i.catchLoc=u[1]),2 in u&&(i.finallyLoc=u[2],i.afterLoc=u[3]),this.tryEntries.push(i)}function _(u){var i=u.completion||{};i.type="normal",delete i.arg,u.completion=i}function N(u){this.tryEntries=[{tryLoc:"root"}],u.forEach(V,this),this.reset(!0)}function M(u){if(u||u===""){var i=u[l];if(i)return i.call(u);if(typeof u.next=="function")return u;if(!isNaN(u.length)){var a=-1,h=function y(){for(;++a<u.length;)if(n.call(u,a))return y.value=u[a],y.done=!1,y;return y.value=e,y.done=!0,y};return h.next=h}}throw new TypeError(I(u)+" is not iterable")}return v.prototype=g,o(S,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=m(g,f,"GeneratorFunction"),t.isGeneratorFunction=function(u){var i=typeof u=="function"&&u.constructor;return!!i&&(i===v||(i.displayName||i.name)==="GeneratorFunction")},t.mark=function(u){return Object.setPrototypeOf?Object.setPrototypeOf(u,g):(u.__proto__=g,m(u,f,"GeneratorFunction")),u.prototype=Object.create(S),u},t.awrap=function(u){return{__await:u}},E(O.prototype),m(O.prototype,c,function(){return this}),t.AsyncIterator=O,t.async=function(u,i,a,h,y){y===void 0&&(y=Promise);var p=new O(w(u,i,a,h),y);return t.isGeneratorFunction(i)?p:p.next().then(function(P){return P.done?P.value:p.next()})},E(S),m(S,f,"Generator"),m(S,l,function(){return this}),m(S,"toString",function(){return"[object Generator]"}),t.keys=function(u){var i=Object(u),a=[];for(var h in i)a.push(h);return a.reverse(),function y(){for(;a.length;){var p=a.pop();if(p in i)return y.value=p,y.done=!1,y}return y.done=!0,y}},t.values=M,N.prototype={constructor:N,reset:function(i){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!i)for(var a in this)a.charAt(0)==="t"&&n.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=e)},stop:function(){this.done=!0;var i=this.tryEntries[0].completion;if(i.type==="throw")throw i.arg;return this.rval},dispatchException:function(i){if(this.done)throw i;var a=this;function h(L,T){return P.type="throw",P.arg=i,a.next=L,T&&(a.method="next",a.arg=e),!!T}for(var y=this.tryEntries.length-1;y>=0;--y){var p=this.tryEntries[y],P=p.completion;if(p.tryLoc==="root")return h("end");if(p.tryLoc<=this.prev){var x=n.call(p,"catchLoc"),j=n.call(p,"finallyLoc");if(x&&j){if(this.prev<p.catchLoc)return h(p.catchLoc,!0);if(this.prev<p.finallyLoc)return h(p.finallyLoc)}else if(x){if(this.prev<p.catchLoc)return h(p.catchLoc,!0)}else{if(!j)throw Error("try statement without catch or finally");if(this.prev<p.finallyLoc)return h(p.finallyLoc)}}}},abrupt:function(i,a){for(var h=this.tryEntries.length-1;h>=0;--h){var y=this.tryEntries[h];if(y.tryLoc<=this.prev&&n.call(y,"finallyLoc")&&this.prev<y.finallyLoc){var p=y;break}}p&&(i==="break"||i==="continue")&&p.tryLoc<=a&&a<=p.finallyLoc&&(p=null);var P=p?p.completion:{};return P.type=i,P.arg=a,p?(this.method="next",this.next=p.finallyLoc,R):this.complete(P)},complete:function(i,a){if(i.type==="throw")throw i.arg;return i.type==="break"||i.type==="continue"?this.next=i.arg:i.type==="return"?(this.rval=this.arg=i.arg,this.method="return",this.next="end"):i.type==="normal"&&a&&(this.next=a),R},finish:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var h=this.tryEntries[a];if(h.finallyLoc===i)return this.complete(h.completion,h.afterLoc),_(h),R}},catch:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var h=this.tryEntries[a];if(h.tryLoc===i){var y=h.completion;if(y.type==="throw"){var p=y.arg;_(h)}return p}}throw Error("illegal catch attempt")},delegateYield:function(i,a,h){return this.delegate={iterator:M(i),resultName:a,nextLoc:h},this.method==="next"&&(this.arg=e),R}},t}function Ve(e,t,r,n,o,s,l){try{var c=e[s](l),f=c.value}catch(m){r(m);return}c.done?t(f):Promise.resolve(f).then(n,o)}function mr(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var s=e.apply(t,r);function l(f){Ve(s,n,o,l,c,"next",f)}function c(f){Ve(s,n,o,l,c,"throw",f)}l(void 0)})}}function Ut(e,t){return br(e)||vr(e,t)||Ot(e,t)||gr()}function gr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vr(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,s,l,c=[],f=!0,m=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(f=(n=s.call(r)).done)&&(c.push(n.value),c.length!==t);f=!0);}catch(w){m=!0,o=w}finally{try{if(!f&&r.return!=null&&(l=r.return(),Object(l)!==l))return}finally{if(m)throw o}}return c}}function br(e){if(Array.isArray(e))return e}function I(e){"@babel/helpers - typeof";return I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(e)}function _r(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Ot(e))||t){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(m){throw m},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,l=!1,c;return{s:function(){r=r.call(e)},n:function(){var m=r.next();return s=m.done,m},e:function(m){l=!0,c=m},f:function(){try{!s&&r.return!=null&&r.return()}finally{if(l)throw c}}}}function Ot(e,t){if(e){if(typeof e=="string")return Xe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xe(e,t)}}function Xe(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ze(Object(r),!0).forEach(function(n){wr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ze(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wr(e,t,r){return t=xt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xt(n.key),n)}}function Pr(e,t,r){return t&&Ye(e.prototype,t),r&&Ye(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xt(e){var t=Ur(e,"string");return I(t)=="symbol"?t:t+""}function Ur(e,t){if(I(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(I(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var de="tus-v1",ye="ietf-draft-03",te="ietf-draft-05",Or={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:Et,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:de},me=(function(){function e(t,r){Sr(this,e),"resume"in r&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=r,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=t,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return Pr(e,[{key:"findPreviousUploads",value:function(){var r=this;return this.options.fingerprint(this.file,this.options).then(function(n){return r._urlStorage.findUploadsByFingerprint(n)})}},{key:"resumeFromPreviousUpload",value:function(r){this.url=r.uploadUrl||null,this._parallelUploadUrls=r.parallelUploadUrls||null,this._urlStorageKey=r.urlStorageKey}},{key:"start",value:function(){var r=this,n=this.file;if(!n){this._emitError(new Error("tus: no file or stream to upload provided"));return}if(![de,ye,te].includes(this.options.protocol)){this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));return}var o=this.options.retryDelays;if(o!=null&&Object.prototype.toString.call(o)!=="[object Array]"){this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"));return}if(this.options.parallelUploads>1)for(var s=0,l=["uploadUrl","uploadSize","uploadLengthDeferred"];s<l.length;s++){var c=l[s];if(this.options[c]){this._emitError(new Error("tus: cannot use the ".concat(c," option when parallelUploads is enabled")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"));return}}this.options.fingerprint(n,this.options).then(function(f){return r._fingerprint=f,r._source?r._source:r.options.fileReader.openFile(n,r.options.chunkSize)}).then(function(f){if(r._source=f,r.options.uploadLengthDeferred)r._size=null;else if(r.options.uploadSize!=null){if(r._size=Number(r.options.uploadSize),Number.isNaN(r._size)){r._emitError(new Error("tus: cannot convert `uploadSize` option into a number"));return}}else if(r._size=r._source.size,r._size==null){r._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return}r.options.parallelUploads>1||r._parallelUploadUrls!=null?r._startParallelUpload():r._startSingleUpload()}).catch(function(f){r._emitError(f)})}},{key:"_startParallelUpload",value:function(){var r,n=this,o=this._size,s=0;this._parallelUploads=[];var l=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,c=(r=this.options.parallelUploadBoundaries)!==null&&r!==void 0?r:Er(this._source.size,l);this._parallelUploadUrls&&c.forEach(function(w,k){w.uploadUrl=n._parallelUploadUrls[k]||null}),this._parallelUploadUrls=new Array(c.length);var f=c.map(function(w,k){var C=0;return n._source.slice(w.start,w.end).then(function(B){var q=B.value;return new Promise(function(A,R){var H=X(X({},n.options),{},{uploadUrl:w.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:n.options.metadataForPartialUploads,headers:X(X({},n.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:A,onError:R,onProgress:function(b){s=s-C+b,C=b,n._emitProgress(s,o)},onUploadUrlAvailable:function(){n._parallelUploadUrls[k]=v.url,n._parallelUploadUrls.filter(function(b){return!!b}).length===c.length&&n._saveUploadInUrlStorage()}}),v=new e(q,H);v.start(),n._parallelUploads.push(v)})})}),m;Promise.all(f).then(function(){m=n._openRequest("POST",n.options.endpoint),m.setHeader("Upload-Concat","final;".concat(n._parallelUploadUrls.join(" ")));var w=Je(n.options.metadata);return w!==""&&m.setHeader("Upload-Metadata",w),n._sendRequest(m,null)}).then(function(w){if(!Z(w.getStatus(),200)){n._emitHttpError(m,w,"tus: unexpected response while creating upload");return}var k=w.getHeader("Location");if(k==null){n._emitHttpError(m,w,"tus: invalid or missing Location header");return}n.url=tt(n.options.endpoint,k),"Created upload at ".concat(n.url),n._emitSuccess(w)}).catch(function(w){n._emitError(w)})}},{key:"_startSingleUpload",value:function(){if(this._aborted=!1,this.url!=null){"Resuming upload from previous URL: ".concat(this.url),this._resumeUpload();return}if(this.options.uploadUrl!=null){"Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,this._resumeUpload();return}this._createUpload()}},{key:"abort",value:function(r){var n=this;if(this._parallelUploads!=null){var o=_r(this._parallelUploads),s;try{for(o.s();!(s=o.n()).done;){var l=s.value;l.abort(r)}}catch(c){o.e(c)}finally{o.f()}}return this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!r||this.url==null?Promise.resolve():e.terminate(this.url,this.options).then(function(){return n._removeFromUrlStorage()})}},{key:"_emitHttpError",value:function(r,n,o,s){this._emitError(new fe(o,s,r,n))}},{key:"_emitError",value:function(r){var n=this;if(!this._aborted){if(this.options.retryDelays!=null){var o=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(o&&(this._retryAttempt=0),et(r,this._retryAttempt,this.options)){var s=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){n.start()},s);return}}if(typeof this.options.onError=="function")this.options.onError(r);else throw r}}},{key:"_emitSuccess",value:function(r){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess=="function"&&this.options.onSuccess({lastResponse:r})}},{key:"_emitProgress",value:function(r,n){typeof this.options.onProgress=="function"&&this.options.onProgress(r,n)}},{key:"_emitChunkComplete",value:function(r,n,o){typeof this.options.onChunkComplete=="function"&&this.options.onChunkComplete(r,n,o)}},{key:"_createUpload",value:function(){var r=this;if(!this.options.endpoint){this._emitError(new Error("tus: unable to create upload because no endpoint is provided"));return}var n=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?n.setHeader("Upload-Defer-Length","1"):n.setHeader("Upload-Length","".concat(this._size));var o=Je(this.options.metadata);o!==""&&n.setHeader("Upload-Metadata",o);var s;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,s=this._addChunkToRequest(n)):((this.options.protocol===ye||this.options.protocol===te)&&n.setHeader("Upload-Complete","?0"),s=this._sendRequest(n,null)),s.then(function(l){if(!Z(l.getStatus(),200)){r._emitHttpError(n,l,"tus: unexpected response while creating upload");return}var c=l.getHeader("Location");if(c==null){r._emitHttpError(n,l,"tus: invalid or missing Location header");return}if(r.url=tt(r.options.endpoint,c),"Created upload at ".concat(r.url),typeof r.options.onUploadUrlAvailable=="function"&&r.options.onUploadUrlAvailable(),r._size===0){r._emitSuccess(l),r._source.close();return}r._saveUploadInUrlStorage().then(function(){r.options.uploadDataDuringCreation?r._handleUploadResponse(n,l):(r._offset=0,r._performUpload())})}).catch(function(l){r._emitHttpError(n,null,"tus: failed to create upload",l)})}},{key:"_resumeUpload",value:function(){var r=this,n=this._openRequest("HEAD",this.url),o=this._sendRequest(n,null);o.then(function(s){var l=s.getStatus();if(!Z(l,200)){if(l===423){r._emitHttpError(n,s,"tus: upload is currently locked; retry later");return}if(Z(l,400)&&r._removeFromUrlStorage(),!r.options.endpoint){r._emitHttpError(n,s,"tus: unable to resume upload (new upload cannot be created without an endpoint)");return}r.url=null,r._createUpload();return}var c=Number.parseInt(s.getHeader("Upload-Offset"),10);if(Number.isNaN(c)){r._emitHttpError(n,s,"tus: invalid or missing offset value");return}var f=Number.parseInt(s.getHeader("Upload-Length"),10);if(Number.isNaN(f)&&!r.options.uploadLengthDeferred&&r.options.protocol===de){r._emitHttpError(n,s,"tus: invalid or missing length value");return}typeof r.options.onUploadUrlAvailable=="function"&&r.options.onUploadUrlAvailable(),r._saveUploadInUrlStorage().then(function(){if(c===f){r._emitProgress(f,f),r._emitSuccess(s);return}r._offset=c,r._performUpload()})}).catch(function(s){r._emitHttpError(n,null,"tus: failed to resume upload",s)})}},{key:"_performUpload",value:function(){var r=this;if(!this._aborted){var n;this.options.overridePatchMethod?(n=this._openRequest("POST",this.url),n.setHeader("X-HTTP-Method-Override","PATCH")):n=this._openRequest("PATCH",this.url),n.setHeader("Upload-Offset","".concat(this._offset));var o=this._addChunkToRequest(n);o.then(function(s){if(!Z(s.getStatus(),200)){r._emitHttpError(n,s,"tus: unexpected response while uploading chunk");return}r._handleUploadResponse(n,s)}).catch(function(s){r._aborted||r._emitHttpError(n,null,"tus: failed to upload chunk at offset ".concat(r._offset),s)})}}},{key:"_addChunkToRequest",value:function(r){var n=this,o=this._offset,s=this._offset+this.options.chunkSize;return r.setProgressHandler(function(l){n._emitProgress(o+l,n._size)}),this.options.protocol===de?r.setHeader("Content-Type","application/offset+octet-stream"):this.options.protocol===te&&r.setHeader("Content-Type","application/partial-upload"),(s===Number.POSITIVE_INFINITY||s>this._size)&&!this.options.uploadLengthDeferred&&(s=this._size),this._source.slice(o,s).then(function(l){var c=l.value,f=l.done,m=c!=null&&c.size?c.size:0;n.options.uploadLengthDeferred&&f&&(n._size=n._offset+m,r.setHeader("Upload-Length","".concat(n._size)));var w=n._offset+m;return!n.options.uploadLengthDeferred&&f&&w!==n._size?Promise.reject(new Error("upload was configured with a size of ".concat(n._size," bytes, but the source is done after ").concat(w," bytes"))):c===null?n._sendRequest(r):((n.options.protocol===ye||n.options.protocol===te)&&r.setHeader("Upload-Complete",f?"?1":"?0"),n._emitProgress(n._offset,n._size),n._sendRequest(r,c))})}},{key:"_handleUploadResponse",value:function(r,n){var o=Number.parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(o)){this._emitHttpError(r,n,"tus: invalid or missing offset value");return}if(this._emitProgress(o,this._size),this._emitChunkComplete(o-this._offset,o,this._size),this._offset=o,o===this._size){this._emitSuccess(n),this._source.close();return}this._performUpload()}},{key:"_openRequest",value:function(r,n){var o=We(r,n,this.options);return this._req=o,o}},{key:"_removeFromUrlStorage",value:function(){var r=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(n){r._emitError(n)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var r=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var n={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?n.parallelUploadUrls=this._parallelUploadUrls:n.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,n).then(function(o){r._urlStorageKey=o})}},{key:"_sendRequest",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return Qe(r,n,this.options)}}],[{key:"terminate",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=We("DELETE",r,n);return Qe(o,null,n).then(function(s){if(s.getStatus()!==204)throw new fe("tus: unexpected response while terminating upload",null,o,s)}).catch(function(s){if(s instanceof fe||(s=new fe("tus: failed to terminate upload",s,o,null)),!et(s,0,n))throw s;var l=n.retryDelays[0],c=n.retryDelays.slice(1),f=X(X({},n),{},{retryDelays:c});return new Promise(function(m){return setTimeout(m,l)}).then(function(){return e.terminate(r,f)})})}}])})();function Je(e){return Object.entries(e).map(function(t){var r=Ut(t,2),n=r[0],o=r[1];return"".concat(n," ").concat(lr.encode(String(o)))}).join(",")}function Z(e,t){return e>=t&&e<t+100}function We(e,t,r){var n=r.httpStack.createRequest(e,t);r.protocol===ye?n.setHeader("Upload-Draft-Interop-Version","5"):r.protocol===te?n.setHeader("Upload-Draft-Interop-Version","6"):n.setHeader("Tus-Resumable","1.0.0");for(var o=r.headers||{},s=0,l=Object.entries(o);s<l.length;s++){var c=Ut(l[s],2),f=c[0],m=c[1];n.setHeader(f,m)}if(r.addRequestId){var w=yr();n.setHeader("X-Request-ID",w)}return n}function Qe(e,t,r){return je.apply(this,arguments)}function je(){return je=mr(Ee().mark(function e(t,r,n){var o;return Ee().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(typeof n.onBeforeRequest!="function"){l.next=3;break}return l.next=3,n.onBeforeRequest(t);case 3:return l.next=5,t.send(r);case 5:if(o=l.sent,typeof n.onAfterResponse!="function"){l.next=9;break}return l.next=9,n.onAfterResponse(t,o);case 9:return l.abrupt("return",o);case 10:case"end":return l.stop()}},e)})),je.apply(this,arguments)}function xr(){var e=!0;return typeof navigator<"u"&&navigator.onLine===!1&&(e=!1),e}function et(e,t,r){return r.retryDelays==null||t>=r.retryDelays.length||e.originalRequest==null?!1:r&&typeof r.onShouldRetry=="function"?r.onShouldRetry(e,t,r):Et(e)}function Et(e){var t=e.originalResponse?e.originalResponse.getStatus():0;return(!Z(t,400)||t===409||t===423)&&xr()}function tt(e,t){return new dr(t,e).toString()}function Er(e,t){for(var r=Math.floor(e/t),n=[],o=0;o<t;o++)n.push({start:r*o,end:r*(o+1)});return n[t-1].end=e,n}me.defaultOptions=Or;var jt=function(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"};function jr(e){return new Promise(function(t,r){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var o=n.response;t(o)},n.onerror=function(o){r(o)},n.open("GET",e),n.send()})}var kr=function(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")};function Rr(e){return new Promise(function(t,r){var n=new FileReader;n.onload=function(){var o=new Uint8Array(n.result);t({value:o})},n.onerror=function(o){r(o)},n.readAsArrayBuffer(e)})}function ae(e){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(e)}function Ar(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fr(n.key),n)}}function Tr(e,t,r){return t&&Cr(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fr(e){var t=Lr(e,"string");return ae(t)=="symbol"?t:t+""}function Lr(e,t){if(ae(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ae(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var rt=(function(){function e(t){Ar(this,e),this._file=t,this.size=t.size}return Tr(e,[{key:"slice",value:function(r,n){if(kr())return Rr(this._file.slice(r,n));var o=this._file.slice(r,n),s=n>=this.size;return Promise.resolve({value:o,done:s})}},{key:"close",value:function(){}}])})();function se(e){"@babel/helpers - typeof";return se=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(e)}function Dr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nr(n.key),n)}}function Hr(e,t,r){return t&&$r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nr(e){var t=qr(e,"string");return se(t)=="symbol"?t:t+""}function qr(e,t){if(se(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(se(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function nt(e){return e===void 0?0:e.size!==void 0?e.size:e.length}function zr(e,t){if(e.concat)return e.concat(t);if(e instanceof Blob)return new Blob([e,t],{type:e.type});if(e.set){var r=new e.constructor(e.length+t.length);return r.set(e),r.set(t,e.length),r}throw new Error("Unknown data type")}var Br=(function(){function e(t){Dr(this,e),this._buffer=void 0,this._bufferOffset=0,this._reader=t,this._done=!1}return Hr(e,[{key:"slice",value:function(r,n){return r<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(r,n)}},{key:"_readUntilEnoughDataOrDone",value:function(r,n){var o=this,s=n<=this._bufferOffset+nt(this._buffer);if(this._done||s){var l=this._getDataFromBuffer(r,n),c=l==null?this._done:!1;return Promise.resolve({value:l,done:c})}return this._reader.read().then(function(f){var m=f.value,w=f.done;return w?o._done=!0:o._buffer===void 0?o._buffer=m:o._buffer=zr(o._buffer,m),o._readUntilEnoughDataOrDone(r,n)})}},{key:"_getDataFromBuffer",value:function(r,n){r>this._bufferOffset&&(this._buffer=this._buffer.slice(r-this._bufferOffset),this._bufferOffset=r);var o=nt(this._buffer)===0;return this._done&&o?null:this._buffer.slice(0,n-r)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])})();function K(e){"@babel/helpers - typeof";return K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(e)}function ke(){ke=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(u,i,a){u[i]=a.value},s=typeof Symbol=="function"?Symbol:{},l=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",f=s.toStringTag||"@@toStringTag";function m(u,i,a){return Object.defineProperty(u,i,{value:a,enumerable:!0,configurable:!0,writable:!0}),u[i]}try{m({},"")}catch{m=function(a,h,y){return a[h]=y}}function w(u,i,a,h){var y=i&&i.prototype instanceof H?i:H,p=Object.create(y.prototype),P=new N(h||[]);return o(p,"_invoke",{value:$(u,a,P)}),p}function k(u,i,a){try{return{type:"normal",arg:u.call(i,a)}}catch(h){return{type:"throw",arg:h}}}t.wrap=w;var C="suspendedStart",B="suspendedYield",q="executing",A="completed",R={};function H(){}function v(){}function g(){}var b={};m(b,l,function(){return this});var d=Object.getPrototypeOf,U=d&&d(d(M([])));U&&U!==r&&n.call(U,l)&&(b=U);var S=g.prototype=H.prototype=Object.create(b);function E(u){["next","throw","return"].forEach(function(i){m(u,i,function(a){return this._invoke(i,a)})})}function O(u,i){function a(y,p,P,x){var j=k(u[y],u,p);if(j.type!=="throw"){var L=j.arg,T=L.value;return T&&K(T)=="object"&&n.call(T,"__await")?i.resolve(T.__await).then(function(D){a("next",D,P,x)},function(D){a("throw",D,P,x)}):i.resolve(T).then(function(D){L.value=D,P(L)},function(D){return a("throw",D,P,x)})}x(j.arg)}var h;o(this,"_invoke",{value:function(p,P){function x(){return new i(function(j,L){a(p,P,j,L)})}return h=h?h.then(x,x):x()}})}function $(u,i,a){var h=C;return function(y,p){if(h===q)throw Error("Generator is already running");if(h===A){if(y==="throw")throw p;return{value:e,done:!0}}for(a.method=y,a.arg=p;;){var P=a.delegate;if(P){var x=z(P,a);if(x){if(x===R)continue;return x}}if(a.method==="next")a.sent=a._sent=a.arg;else if(a.method==="throw"){if(h===C)throw h=A,a.arg;a.dispatchException(a.arg)}else a.method==="return"&&a.abrupt("return",a.arg);h=q;var j=k(u,i,a);if(j.type==="normal"){if(h=a.done?A:B,j.arg===R)continue;return{value:j.arg,done:a.done}}j.type==="throw"&&(h=A,a.method="throw",a.arg=j.arg)}}}function z(u,i){var a=i.method,h=u.iterator[a];if(h===e)return i.delegate=null,a==="throw"&&u.iterator.return&&(i.method="return",i.arg=e,z(u,i),i.method==="throw")||a!=="return"&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+a+"' method")),R;var y=k(h,u.iterator,i.arg);if(y.type==="throw")return i.method="throw",i.arg=y.arg,i.delegate=null,R;var p=y.arg;return p?p.done?(i[u.resultName]=p.value,i.next=u.nextLoc,i.method!=="return"&&(i.method="next",i.arg=e),i.delegate=null,R):p:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,R)}function V(u){var i={tryLoc:u[0]};1 in u&&(i.catchLoc=u[1]),2 in u&&(i.finallyLoc=u[2],i.afterLoc=u[3]),this.tryEntries.push(i)}function _(u){var i=u.completion||{};i.type="normal",delete i.arg,u.completion=i}function N(u){this.tryEntries=[{tryLoc:"root"}],u.forEach(V,this),this.reset(!0)}function M(u){if(u||u===""){var i=u[l];if(i)return i.call(u);if(typeof u.next=="function")return u;if(!isNaN(u.length)){var a=-1,h=function y(){for(;++a<u.length;)if(n.call(u,a))return y.value=u[a],y.done=!1,y;return y.value=e,y.done=!0,y};return h.next=h}}throw new TypeError(K(u)+" is not iterable")}return v.prototype=g,o(S,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:v,configurable:!0}),v.displayName=m(g,f,"GeneratorFunction"),t.isGeneratorFunction=function(u){var i=typeof u=="function"&&u.constructor;return!!i&&(i===v||(i.displayName||i.name)==="GeneratorFunction")},t.mark=function(u){return Object.setPrototypeOf?Object.setPrototypeOf(u,g):(u.__proto__=g,m(u,f,"GeneratorFunction")),u.prototype=Object.create(S),u},t.awrap=function(u){return{__await:u}},E(O.prototype),m(O.prototype,c,function(){return this}),t.AsyncIterator=O,t.async=function(u,i,a,h,y){y===void 0&&(y=Promise);var p=new O(w(u,i,a,h),y);return t.isGeneratorFunction(i)?p:p.next().then(function(P){return P.done?P.value:p.next()})},E(S),m(S,f,"Generator"),m(S,l,function(){return this}),m(S,"toString",function(){return"[object Generator]"}),t.keys=function(u){var i=Object(u),a=[];for(var h in i)a.push(h);return a.reverse(),function y(){for(;a.length;){var p=a.pop();if(p in i)return y.value=p,y.done=!1,y}return y.done=!0,y}},t.values=M,N.prototype={constructor:N,reset:function(i){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!i)for(var a in this)a.charAt(0)==="t"&&n.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=e)},stop:function(){this.done=!0;var i=this.tryEntries[0].completion;if(i.type==="throw")throw i.arg;return this.rval},dispatchException:function(i){if(this.done)throw i;var a=this;function h(L,T){return P.type="throw",P.arg=i,a.next=L,T&&(a.method="next",a.arg=e),!!T}for(var y=this.tryEntries.length-1;y>=0;--y){var p=this.tryEntries[y],P=p.completion;if(p.tryLoc==="root")return h("end");if(p.tryLoc<=this.prev){var x=n.call(p,"catchLoc"),j=n.call(p,"finallyLoc");if(x&&j){if(this.prev<p.catchLoc)return h(p.catchLoc,!0);if(this.prev<p.finallyLoc)return h(p.finallyLoc)}else if(x){if(this.prev<p.catchLoc)return h(p.catchLoc,!0)}else{if(!j)throw Error("try statement without catch or finally");if(this.prev<p.finallyLoc)return h(p.finallyLoc)}}}},abrupt:function(i,a){for(var h=this.tryEntries.length-1;h>=0;--h){var y=this.tryEntries[h];if(y.tryLoc<=this.prev&&n.call(y,"finallyLoc")&&this.prev<y.finallyLoc){var p=y;break}}p&&(i==="break"||i==="continue")&&p.tryLoc<=a&&a<=p.finallyLoc&&(p=null);var P=p?p.completion:{};return P.type=i,P.arg=a,p?(this.method="next",this.next=p.finallyLoc,R):this.complete(P)},complete:function(i,a){if(i.type==="throw")throw i.arg;return i.type==="break"||i.type==="continue"?this.next=i.arg:i.type==="return"?(this.rval=this.arg=i.arg,this.method="return",this.next="end"):i.type==="normal"&&a&&(this.next=a),R},finish:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var h=this.tryEntries[a];if(h.finallyLoc===i)return this.complete(h.completion,h.afterLoc),_(h),R}},catch:function(i){for(var a=this.tryEntries.length-1;a>=0;--a){var h=this.tryEntries[a];if(h.tryLoc===i){var y=h.completion;if(y.type==="throw"){var p=y.arg;_(h)}return p}}throw Error("illegal catch attempt")},delegateYield:function(i,a,h){return this.delegate={iterator:M(i),resultName:a,nextLoc:h},this.method==="next"&&(this.arg=e),R}},t}function ot(e,t,r,n,o,s,l){try{var c=e[s](l),f=c.value}catch(m){r(m);return}c.done?t(f):Promise.resolve(f).then(n,o)}function Mr(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var s=e.apply(t,r);function l(f){ot(s,n,o,l,c,"next",f)}function c(f){ot(s,n,o,l,c,"throw",f)}l(void 0)})}}function Gr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ir(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vr(n.key),n)}}function Kr(e,t,r){return t&&Ir(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vr(e){var t=Xr(e,"string");return K(t)=="symbol"?t:t+""}function Xr(e,t){if(K(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(K(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Zr=(function(){function e(){Gr(this,e)}return Kr(e,[{key:"openFile",value:(function(){var t=Mr(ke().mark(function n(o,s){var l;return ke().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(jt()&&o&&typeof o.uri<"u")){f.next=11;break}return f.prev=1,f.next=4,jr(o.uri);case 4:return l=f.sent,f.abrupt("return",new rt(l));case 8:throw f.prev=8,f.t0=f.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(f.t0));case 11:if(!(typeof o.slice=="function"&&typeof o.size<"u")){f.next=13;break}return f.abrupt("return",Promise.resolve(new rt(o)));case 13:if(typeof o.read!="function"){f.next=18;break}if(s=Number(s),Number.isFinite(s)){f.next=17;break}return f.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return f.abrupt("return",Promise.resolve(new Br(o,s)));case 18:return f.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return f.stop()}},n,null,[[1,8]])}));function r(n,o){return t.apply(this,arguments)}return r})()}])})();function Yr(e,t){return jt()?Promise.resolve(Jr(e,t)):Promise.resolve(["tus-br",e.name,e.type,e.size,e.lastModified,t.endpoint].join("-"))}function Jr(e,t){var r=e.exif?Wr(JSON.stringify(e.exif)):"noexif";return["tus-rn",e.name||"noname",e.size||"nosize",r,t.endpoint].join("/")}function Wr(e){var t=0;if(e.length===0)return t;for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);t=(t<<5)-t+n,t&=t}return t}function ue(e){"@babel/helpers - typeof";return ue=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(e)}function Le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,en(n.key),n)}}function De(e,t,r){return t&&Qr(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function en(e){var t=tn(e,"string");return ue(t)=="symbol"?t:t+""}function tn(e,t){if(ue(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ue(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var rn=(function(){function e(){Le(this,e)}return De(e,[{key:"createRequest",value:function(r,n){return new nn(r,n)}},{key:"getName",value:function(){return"XHRHttpStack"}}])})(),nn=(function(){function e(t,r){Le(this,e),this._xhr=new XMLHttpRequest,this._xhr.open(t,r,!0),this._method=t,this._url=r,this._headers={}}return De(e,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(r,n){this._xhr.setRequestHeader(r,n),this._headers[r]=n}},{key:"getHeader",value:function(r){return this._headers[r]}},{key:"setProgressHandler",value:function(r){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(n){n.lengthComputable&&r(n.loaded)})}},{key:"send",value:function(){var r=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(o,s){r._xhr.onload=function(){o(new on(r._xhr))},r._xhr.onerror=function(l){s(l)},r._xhr.send(n)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})(),on=(function(){function e(t){Le(this,e),this._xhr=t}return De(e,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(r){return this._xhr.getResponseHeader(r)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})();function le(e){"@babel/helpers - typeof";return le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},le(e)}function an(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ln(n.key),n)}}function un(e,t,r){return t&&sn(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ln(e){var t=fn(e,"string");return le(t)=="symbol"?t:t+""}function fn(e,t){if(le(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(le(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Re=!1;try{Re="localStorage"in window;var _e="tusSupport",it=localStorage.getItem(_e);localStorage.setItem(_e,it),it===null&&localStorage.removeItem(_e)}catch(e){if(e.code===e.SECURITY_ERR||e.code===e.QUOTA_EXCEEDED_ERR)Re=!1;else throw e}var cn=Re,hn=(function(){function e(){an(this,e)}return un(e,[{key:"findAllUploads",value:function(){var r=this._findEntries("tus::");return Promise.resolve(r)}},{key:"findUploadsByFingerprint",value:function(r){var n=this._findEntries("tus::".concat(r,"::"));return Promise.resolve(n)}},{key:"removeUpload",value:function(r){return localStorage.removeItem(r),Promise.resolve()}},{key:"addUpload",value:function(r,n){var o=Math.round(Math.random()*1e12),s="tus::".concat(r,"::").concat(o);return localStorage.setItem(s,JSON.stringify(n)),Promise.resolve(s)}},{key:"_findEntries",value:function(r){for(var n=[],o=0;o<localStorage.length;o++){var s=localStorage.key(o);if(s.indexOf(r)===0)try{var l=JSON.parse(localStorage.getItem(s));l.urlStorageKey=s,n.push(l)}catch{}}return n}}])})();function W(e){"@babel/helpers - typeof";return W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(e)}function pn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rt(n.key),n)}}function yn(e,t,r){return r&&dn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mn(e,t,r){return t=ge(t),gn(e,kt()?Reflect.construct(t,r||[],ge(e).constructor):t.apply(e,r))}function gn(e,t){if(t&&(W(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vn(e)}function vn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kt=function(){return!!e})()}function ge(e){return ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ge(e)}function bn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ae(e,t)}function Ae(e,t){return Ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},Ae(e,t)}function at(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?at(Object(r),!0).forEach(function(n){_n(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):at(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _n(e,t,r){return t=Rt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rt(e){var t=wn(e,"string");return W(t)=="symbol"?t:t+""}function wn(e,t){if(W(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(W(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var st=Y(Y({},me.defaultOptions),{},{httpStack:new rn,fileReader:new Zr,urlStorage:cn?new hn:new Wt,fingerprint:Yr}),Sn=(function(e){function t(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return pn(this,t),n=Y(Y({},st),n),mn(this,t,[r,n])}return bn(t,e),yn(t,null,[{key:"terminate",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return o=Y(Y({},st),o),me.terminate(n,o)}}])})(me),Pn=Object.defineProperty,Un=Object.defineProperties,On=Object.getOwnPropertyDescriptors,ut=Object.getOwnPropertySymbols,xn=Object.prototype.hasOwnProperty,En=Object.prototype.propertyIsEnumerable,lt=(e,t,r)=>t in e?Pn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,we=(e,t)=>{for(var r in t||(t={}))xn.call(t,r)&&lt(e,r,t[r]);if(ut)for(var r of ut(t))En.call(t,r)&&lt(e,r,t[r]);return e},jn=(e,t)=>Un(e,On(t)),re=(e,t,r)=>new Promise((n,o)=>{var s=f=>{try{c(r.next(f))}catch(m){o(m)}},l=f=>{try{c(r.throw(f))}catch(m){o(m)}},c=f=>f.done?n(f.value):Promise.resolve(f.value).then(s,l);c((r=r.apply(e,t)).next())}),kn=class{constructor(e){this._body="",this._response=e}getStatus(){return this._response.status}getHeader(e){return this._response.headers.get(e)||void 0}getBody(){return this._body}parseBody(){return re(this,null,function*(){this._body=yield this._response.text()})}getUnderlyingObject(){return this._response}},Rn=class{constructor(e,t){this._method=e,this._url=t,this._headers={},this._abortController=new AbortController}getMethod(){return this._method}getURL(){return this._url}setHeader(e,t){this._headers[e]=t}getHeader(e){return this._headers[e]}setProgressHandler(e){this._progressHandler=e}send(e=null){return re(this,null,function*(){var t;try{const r=yield fetch(this._url,{method:this._method,headers:this._headers,body:e,signal:this._abortController.signal,credentials:"include"});if(this._progressHandler){const o=(t=r.clone().body)==null?void 0:t.getReader();if(o){let s=0,l,c;for(;!l&&({value:c,done:l}=yield o.read(),!l);)s+=c?.length||0,this._progressHandler(s)}}const n=new kn(r.clone());return n.parseBody(),n}catch(r){throw r.name==="AbortError"?new Error("Request aborted"):r}})}abort(){return this._abortController.abort(),Promise.resolve()}getUnderlyingObject(){return this._abortController}},ft=class{createRequest(e,t){return new Rn(e,t)}getName(){return"FetchHttpStack"}},An=e=>{let t=0;if(e.length===0)return t;for(let r=0;r<e.length;r++){const n=e.charCodeAt(r);t=(t<<5)-t+n,t=t&t}return t},Cn=e=>e.originalResponse!==void 0,At=(e,t,r)=>new Promise(n=>{const{metadata:o={},endpoint:s}=t,l=Object.values(o),c=[e.name,e.type,e.size,e.lastModified],f=[c.toString().replaceAll(",",""),s,l].join(""),m=Math.abs(An(f)),w=["tus",...c,m].filter(k=>k??!1).join("-");n(r?r(null,w):w)}),Tn={endpoint:"/ms/api/availity/internal/core/vault/upload/v1/resumable",chunkSize:6e6,removeFingerprintOnSuccess:!0,pollingTime:5e3,retryDelays:[0,1e3,3e3,5e3],stripFileNamePathSegments:!0,onPreStart:[],maxAvScanRetries:10,fingerprint:At},Fn=class{constructor(e,t){if(!e)throw new Error("[file] must be defined and of type File");if(!t||!t.bucketId)throw new Error("[options.bucketId] must be defined");if(!t.customerId)throw new Error("[options.customerId] must be defined");if(!t.clientId)throw new Error("[options.clientId] must be defined");this.file=e,this.options=we(we({},Tn),t),this.options.endpoint=Ht({relative:this.options.endpoint}),this.avScanRetries=0,this.bytesAccepted=0,this.bytesScanned=0,this.bytesSent=0,this.bytesTotal=0,this.chunkSize=0,this.error=null,this.errorMessage="",this.id="",this.onError=[],this.onPreStart=this.options.onPreStart||[],this.onProgress=[],this.onSuccess=[],this.onChunkComplete=[],this.percentage=0,this.preStartValidationResults=[],this.references=[],this.s3References=[],this.status="pending",this.timeoutId=void 0,this.waitForPassword=!0;const n={"availity-filename":this.trimFileName(e.name),"availity-content-type":e.type,"availity-attachment-name":"N/A"};Object.assign(n,this.options.metadata);const o=new Sn(this.file,{endpoint:`${this.options.endpoint}/${this.options.bucketId}/`,chunkSize:this.options.chunkSize,retryDelays:this.options.retryDelays,removeFingerprintOnSuccess:this.options.removeFingerprintOnSuccess,fingerprint:this.options.fingerprint,metadata:n,headers:jn(we({},this.options.headers),{"X-XSRF-TOKEN":this.getToken(),"X-Availity-Customer-ID":this.options.customerId,"X-Client-ID":this.options.clientId}),httpStack:new ft,onError:s=>{this.setError("rejected","Network Error",s),this.error=s},onProgress:(s,l)=>{this.bytesSent=s,this.bytesTotal=l,this.percentage=this.getPercentage();for(const c of this.onProgress)c()},onChunkComplete:(s,l,c)=>{this.chunkSize=s,this.bytesAccepted=l,this.bytesTotal=c;for(const f of this.onChunkComplete)f(s,l,c)},onSuccess:s=>{this.bytesScanned=Number.parseInt(s.lastResponse.getHeader("AV-Scan-Bytes")||"0",10),this.percentage=this.getPercentage();const l=this.getResult(s.lastResponse);if(l.status==="accepted"){this.percentage=100,this.status=l.status,this.errorMessage="",this.error=null;const c=s.lastResponse.getHeader("references"),f=s.lastResponse.getHeader("s3-references");c&&(this.references=JSON.parse(c)),f&&(this.s3References=JSON.parse(f));for(const m of this.onSuccess)m(s);return}if(l.status==="rejected"){this.setError(l.status,l.message);return}this.scan()}});this.upload=o}inStatusCategory(e,t){return e>=t&&e<t+100}scan(e){return re(this,null,function*(){clearTimeout(this.timeoutId);try{const r=new ft().createRequest("HEAD",this.upload.url||this.options.endpoint),n={"Tus-Resumable":"1.0.0","X-Client-ID":this.options.clientId,"X-Availity-Customer-ID":this.options.customerId,"X-XSRF-TOKEN":this.getToken()};e&&(n[e.header]=e.value);for(const[l,c]of Object.entries(n))r.setHeader(l,c);const o=yield r.send();if(!this.inStatusCategory(o.getStatus(),200)){this.setError("rejected",`Invalid status returned: ${o.getStatus()}`);return}this.bytesScanned=Number.parseInt(o.getHeader("AV-Scan-Bytes")||"0",10),this.percentage=this.getPercentage();const s=this.getResult(o);if(s.status==="rejected"){this.setError(s.status,s.message);return}if(s.status==="encrypted"&&this.waitForPassword){this.setError(s.status,s.message),clearTimeout(this.timeoutId);return}if(s.status==="accepted"){this.percentage=100,this.status=s.status,this.errorMessage="",this.error=null;const l=o.getHeader("references"),c=o.getHeader("s3-references");l&&(this.references=JSON.parse(l)),c&&(this.s3References=JSON.parse(c));for(const f of this.onSuccess)f({lastResponse:o});return}s.status==="decrypting"&&this.setError(s.status,s.message);for(const l of this.onProgress)l()}catch(t){this.setError("rejected","Network Error",t),this.error=t}if(this.avScanRetries>this.options.maxAvScanRetries){this.setError("rejected","AV scan timed out, max retries exceeded");return}this.timeoutId=setTimeout(()=>{this.avScanRetries+=1,this.scan()},this.options.pollingTime)})}getPercentage(){if(!this.bytesTotal)return 0;const e=this.bytesSent+this.bytesScanned,t=this.bytesTotal*2;return e/t*100}getToken(){return document.cookie.replace(/(?:(?:^|.*;\s*)XSRF-TOKEN\s*=\s*([^;]*).*$)|^.*$/,"$1")}start(){if(this.isValidFile()){if(!this.id){this.setError("rejected","No id set. Call `generateId` or set one manually with `setId` before calling `start`.");return}for(const e of this.onPreStart)this.preStartValidationResults.push(e(this));if(this.preStartValidationResults.some(e=>!e)){this.status==="pending"&&this.setError("rejected","preStart validation failed");return}this.upload.start()}}setId(e){this.id=e}generateId(){return re(this,null,function*(){const{fingerprint:e}=this.options,t=yield e(this.file,this.options);return this.setId(t.replaceAll(/[^\dA-Za-z-]/g,"")),this.id})}fingerprint(e,t,r){return re(this,null,function*(){return At(e,t,r)})}sendPassword(e){this.waitForPassword=!1,this.scan({header:"Encryption-Password",value:e})}isValidSize(){return this.options.maxSize&&this.file.size>this.options.maxSize?(this.setError("rejected","Document is too large"),!1):!0}isAllowedFileTypes(){if(!this.options.fileTypes||this.options.fileTypes.length===0)return!0;if(!this.file.name)return!1;const e=this.file.name,t=e.substring(e.lastIndexOf(".")).toLowerCase();return this.options.fileTypes=this.options.fileTypes.map(r=>r.toLowerCase()),this.options.fileTypes.includes(t)?!0:(this.setError("rejected",`Document type ${t} is not allowed`),!1)}isAllowedFileNameCharacters(){if(!this.options.allowedFileNameCharacters)return!0;const e=this.file.name.substring(0,this.file.name.lastIndexOf(".")),t=new RegExp(`([^${this.options.allowedFileNameCharacters}])`,"g");return e.match(t)!==null?(this.setError("rejected","File name contains characters not allowed"),!1):!0}isValidFile(){return this.isAllowedFileNameCharacters()&&this.isAllowedFileTypes()&&this.isValidSize()}trimFileName(e){return this.options.stripFileNamePathSegments&&(e=e.substring(e.lastIndexOf("\\")+1),e=e.substring(e.lastIndexOf("/")+1)),e}getResult(e){const t=e.getHeader("av-scan-result"),r=e.getHeader("upload-result"),n=e.getHeader("decryption-result"),o=e.getHeader("upload-message");return t==="rejected"?{status:t,message:o||"Failed AV scan"}:r==="rejected"?(this.waitForPassword=!0,n==="rejected"?{status:r,message:o||"Maximum password attempts reached"}:{status:r,message:o||"File upload rejected"}):r==="encrypted"?!this.waitForPassword&&(n===null||n==="pending")?{status:"decrypting",message:o||"Decrypting file"}:n==="rejected"?(this.waitForPassword=!0,{status:r,message:o||"Incorrect password"}):{status:r,message:o||"Encrypted files require a password"}:t==="accepted"&&r==="accepted"?{status:"accepted",message:o||""}:{status:"pending",message:o||""}}setError(e,t,r){this.status=e;try{this.parseErrorMessage(t,r)}catch{}for(const n of this.onError)n(r||new Error(this.errorMessage))}parseErrorMessage(e,t){if(t){let r="";if(Cn(t)&&(r=t.originalRequest.getHeader("Upload-Message")||""),r||(r=t.message),r){this.errorMessage=r;return}}this.errorMessage=e}abort(){this.upload&&this.upload.abort()}},Dn=Fn;export{Dn as a,Ht as b,Ft as i};
