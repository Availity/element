import{j as l}from"./jsx-runtime-CcL-W3nW.js";import{r as f}from"./index-DcWiA9TO.js";import{s as x}from"./index-DMWJB0MK.js";import{d as k}from"./index-C5soOJ6z.js";import{u as K}from"./useQuery-D4UpBS0N.js";import{S as B,I as X,n as Q,J,u as P,f as Z,K as Y,i as $}from"./suspense-BqeUBMhm.js";import{g as ee,Q as te}from"./queryClient-CjDmLjqo.js";import{T as re}from"./Tooltip-CiiaKkqp.js";import{g as D,q as A}from"./index-4AU0IlPL.js";import{C as ie}from"./index-CgN_Fp17.js";import{s as H}from"./styled-CF1hcdwO.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-uZUcOW5W.js";import"./___vite-browser-external_commonjs-proxy-DRaEfepn.js";import"./index-BXb5JWGK.js";import"./_toKey-MoF_TmUD.js";import"./useBaseQuery-CJ5trF24.js";import"./generateUtilityClass-CVWqFxsA.js";import"./identifier-Dtqimryx.js";import"./index-nos-0K8U.js";import"./useTheme-DUkCvbx_.js";import"./DefaultPropsProvider-_cNB_dWy.js";import"./useTheme-C2CrmYKc.js";import"./memoTheme-D-rVhYRp.js";import"./useSlot-DnkSxE3X.js";import"./resolveComponentProps-Dg20wxiM.js";import"./useForkRef-BVrIj09m.js";import"./generateUtilityClasses-BGOCnVj7.js";import"./useTimeout-B8wmcRZV.js";import"./useEnhancedEffect-D2f2tbda.js";import"./useControlled-WdbyInBW.js";import"./useId-DszduLV4.js";import"./getReactElementRef-AnOffBoZ.js";import"./Portal-CBAx_nZm.js";import"./utils-D5ZkK9XY.js";import"./objectWithoutPropertiesLoose-CAYKN5F1.js";import"./TransitionGroupContext-D-IBNIfW.js";import"./index-BEx9gAkE.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlotProps-BAIpVL6Y.js";import"./isFocusVisible-B8k4qzLc.js";import"./faCircleArrowRight-BeBmJtPK.js";import"./faUser-DXPB7Q64.js";import"./faSortDown-nq-jkck6.js";import"./SvgIcon-DSdWmKAH.js";import"./index-BtPDELIe.js";import"./Typography-CvSvtD2a.js";import"./index-f0Aa_BgU.js";import"./extendSxProp-B5AgUjQT.js";import"./emotion-react.browser.esm-CU7ej9d2.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./Stack-BcsM4Vc0.js";import"./styled-vBjI3IQc.js";import"./useThemeProps-BIK-1DKm.js";import"./CircularProgress-D8w9ZPs6.js";import"./LinearProgress-aFncvf6g.js";import"./Box-DWnb8VZB.js";class se extends B{constructor(t,r){super(),this.client=t,this.setOptions(r),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const i=this.options;this.options=this.client.defaultMutationOptions(t),X(i,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),(r=this.currentMutation)==null||r.setOptions(this.options)}onUnsubscribe(){if(!this.hasListeners()){var t;(t=this.currentMutation)==null||t.removeObserver(this)}}onMutationUpdate(t){this.updateResult();const r={listeners:!0};t.type==="success"?r.onSuccess=!0:t.type==="error"&&(r.onError=!0),this.notify(r)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,r){return this.mutateOptions=r,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof t<"u"?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const t=this.currentMutation?this.currentMutation.state:ee(),r={...t,isLoading:t.status==="loading",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=r}notify(t){Q.batch(()=>{if(this.mutateOptions&&this.hasListeners()){if(t.onSuccess){var r,i,s,n;(r=(i=this.mutateOptions).onSuccess)==null||r.call(i,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(s=(n=this.mutateOptions).onSettled)==null||s.call(n,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(t.onError){var a,d,u,c;(a=(d=this.mutateOptions).onError)==null||a.call(d,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(u=(c=this.mutateOptions).onSettled)==null||u.call(c,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}t.listeners&&this.listeners.forEach(({listener:h})=>{h(this.currentResult)})})}}function oe(e,t,r){const i=J(e,t,r),s=P({context:i.context}),[n]=f.useState(()=>new se(s,i));f.useEffect(()=>{n.setOptions(i)},[n,i]);const a=Z(f.useCallback(u=>n.subscribe(Q.batchCalls(u)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),d=f.useCallback((u,c)=>{n.mutate(u,c).catch(ne)},[n]);if(a.error&&Y(n.options.useErrorBoundary,[a.error]))throw a.error;return{...a,mutate:d,mutateAsync:a.mutate}}function ne(){}var ae=Object.defineProperty,ue=Object.defineProperties,le=Object.getOwnPropertyDescriptors,w=Object.getOwnPropertySymbols,U=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable,T=(e,t,r)=>t in e?ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ce=(e,t)=>{for(var r in t||(t={}))U.call(t,r)&&T(e,r,t[r]);if(w)for(var r of w(t))z.call(t,r)&&T(e,r,t[r]);return e},de=(e,t)=>ue(e,le(t)),pe=(e,t)=>{var r={};for(var i in e)U.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&w)for(var i of w(e))t.indexOf(i)<0&&z.call(e,i)&&(r[i]=e[i]);return r},ve=e=>{const t=e,{children:r,dangerouslySetTransitionTimer:i}=t,s=pe(t,["children","dangerouslySetTransitionTimer"]);return l.jsx(re,de(ce({},s),{TransitionProps:{timeout:i!==void 0?i:100},arrow:!0,children:r}))};const me=60,W="Gateway-AvNavigation",S={FAVORITES_UPDATE:"av:favorites:update",FAVORITES_CHANGED:"av:favorites:changed",MAX_FAVORITES:"av:favorites:maxed"},fe=e=>typeof(e==null?void 0:e.id)=="string"&&typeof(e==null?void 0:e.pos)=="number",he=e=>Array.isArray(e)?e==null?void 0:e.filter(fe):[],ye=async({favorites:e,targetFavoriteId:t})=>({favorites:(await k.setApplication(W,{favorites:e})).data.favorites,targetFavoriteId:t}),Fe=async()=>{var i,s,n;const e=await k.getApplication(W),t=(n=(s=(i=e==null?void 0:e.data)==null?void 0:i.settings)==null?void 0:s[0])==null?void 0:n.favorites;return he(t)},be=e=>K(["favorites"],Fe,{enabled:e}),ge=({onMutationStart:e})=>{const t=P(),{mutateAsync:r,...i}=oe(ye,{onMutate(s){e==null||e(s.targetFavoriteId)},onSuccess(s){t.setQueryData(["favorites"],s.favorites)}});return{submitFavorites:r,...i}},C=e=>{x.send({favorites:e,event:S.FAVORITES_UPDATE})},_e=()=>x.send(S.MAX_FAVORITES),G=f.createContext(null),R=({children:e,onFavoritesChange:t,settingsFavorites:r,settingsStatus:i})=>{const[s,n]=f.useState(""),a=P(),{data:d,status:u}=be(!i),c=i?r:d,h=i||u,{submitFavorites:y,status:m}=ge({onMutationStart(p){n(p)}});f.useEffect(()=>{const p=x.subscribe(S.FAVORITES_CHANGED,o=>{o!=null&&o.favorites&&a.setQueryData(["favorites"],o==null?void 0:o.favorites)},{ignoreSameWindow:!1}),v=x.subscribe(S.FAVORITES_UPDATE,o=>{o!=null&&o.favorites&&a.setQueryData(["favorites"],o==null?void 0:o.favorites)},{ignoreSameWindow:!1});return()=>{p(),v()}},[a]);const g=async p=>{if(c){const v=await y({favorites:c.filter(o=>o.id!==p),targetFavoriteId:p});C(v.favorites),t==null||t(v.favorites)}},b=async p=>{if(!c)return!1;if(c.length>=me)return _e(),!1;const v=c.reduce((F,j)=>((!F||j.pos>F.pos)&&(F=j),F),null),o=v?v.pos+1:0,O=await y({favorites:[...c,{id:p,pos:o}],targetFavoriteId:p});return C(O.favorites),t==null||t(O.favorites),!!O.favorites.find(F=>F.id===p)};return l.jsx(G.Provider,{value:{favorites:c,queryStatus:h,mutationStatus:m,lastClickedFavoriteId:s,deleteFavorite:g,addFavorite:b},children:e})},xe=()=>{},I=e=>{const t=f.useContext(G);if(t===null)throw new Error("useFavorites must be used within a FavoritesProvider");const{favorites:r,queryStatus:i,mutationStatus:s,lastClickedFavoriteId:n,deleteFavorite:a,addFavorite:d}=t,u=n===e,c=f.useMemo(()=>!!(r==null?void 0:r.find(b=>b.id===e)),[r,e]),h=()=>c?a(e):d(e),y=i==="loading"||i==="idle"||s==="loading";let m="initLoading";return i==="loading"&&(m="initLoading"),i==="reloading"&&(m="reloading"),s==="loading"&&(m="reloading"),(i==="error"||s==="error")&&(m="error"),i==="success"&&(s==="success"||s==="idle")&&(m="success"),{isFavorited:c,status:m,isLastClickedFavorite:u,toggleFavorite:y?xe:h}};try{R.displayName="FavoritesProvider",R.__docgenInfo={description:"",displayName:"FavoritesProvider",props:{onFavoritesChange:{defaultValue:null,description:"",name:"onFavoritesChange",required:!1,type:{name:"(favorites: Favorite[]) => void"}},settingsFavorites:{defaultValue:null,description:"",name:"settingsFavorites",required:!1,type:{name:"Favorite[]"}},settingsStatus:{defaultValue:null,description:"",name:"settingsStatus",required:!1,type:{name:"StatusUnion"}}}}}catch{}try{I.displayName="useFavorites",I.__docgenInfo={description:"",displayName:"useFavorites",props:{}}}catch{}const we={spinner:l.jsx(ie,{"aria-hidden":!0,size:"small",loadingCaption:!1}),unknownDisabledHeart:l.jsx(A,{"aria-hidden":!0,color:"disabled"}),favoritedDisabledHeart:l.jsx(A,{"aria-hidden":!0,color:"error",opacity:"0.6"}),unfavoritedDisabledHeart:l.jsx(D,{"aria-hidden":!0,color:"disabled",opacity:"0.6"}),favoritedHeart:l.jsx(A,{"aria-hidden":!0,color:"error"}),unfavoritedHeart:l.jsx(D,{"aria-hidden":!0,color:"secondary"})},M="2.5rem",Se=H("div",{name:"AvFavoriteHeart",slot:"Root"})(({customSize:e})=>({height:e,width:e})),V=H("input",{name:"AvFavoriteHeart",slot:"input"})(({customSize:e})=>({height:e,width:e,minHeight:e,minWidth:e})),Ee=(e=M)=>{const t=e.match(/^(\d*\.?\d+)(px|rem)$/);if(!t)throw new Error("Invalid size format. Must be in 'px' or 'rem'.");const[,r,i]=t;return`${parseFloat(r)/2}${i}`},Oe=H("div",{name:"AvFavoriteHeart",slot:"icon"})(({customSize:e})=>({fontSize:Ee(e)})),Ae=e=>{const t=e.match(/^(\d*\.?\d+)(px|rem)$/);if(!t)return!1;const[,r,i]=t,s=parseFloat(r);return i==="rem"&&s>=1.5?!0:i==="px"&&s>=24},E=({id:e,name:t,onChange:r,onMouseDown:i,disabled:s=!1,customSize:n=M})=>{const{isFavorited:a,isLastClickedFavorite:d,status:u,toggleFavorite:c}=I(e),h=o=>{r==null||r(a,o),c()},y=o=>{(o.code==="Enter"||o.key==="Enter")&&(r==null||r(a,o),c())},m=u==="initLoading"?"unknownDisabledHeart":u==="reloading"?d?"spinner":a?"favoritedDisabledHeart":"unfavoritedDisabledHeart":s?a?"favoritedDisabledHeart":"unfavoritedDisabledHeart":a?"favoritedHeart":"unfavoritedHeart",g=s||!d&&(u==="initLoading"||u==="reloading")?"not-allowed":void 0,b=`${a?"Remove from":"Add to"} My Favorites`,p={onKeyDown:y,type:"checkbox","aria-label":`Favorite ${t}`,id:`av-favorite-heart-${e}`,disabled:s,checked:a,onChange:h,onMouseDown:i,style:{cursor:g}},v=Ae(n)?n:M;return l.jsxs(Se,{customSize:v,children:[l.jsx(Oe,{customSize:v,children:we[m]}),l.jsx("span",{style:{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},"aria-live":d&&(u==="reloading"||u==="error")?"polite":"off",children:d&&u==="reloading"?"Loading...":d&&u==="error"?"An error has occurred. Please try again.":""}),s?l.jsx(V,{customSize:v,...p}):l.jsx(ve,{title:b,placement:"top",children:l.jsx(V,{customSize:v,...p})})]})};try{E.displayName="FavoriteHeart",E.__docgenInfo={description:"",displayName:"FavoriteHeart",props:{id:{defaultValue:null,description:"The configuration's id",name:"id",required:!0,type:{name:"string"}},name:{defaultValue:null,description:"The name of the configuration",name:"name",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"What to do on Favorite Toggle",name:"onChange",required:!1,type:{name:"(isFavorited: boolean, event: any) => void"}},onMouseDown:{defaultValue:null,description:"What to do on click",name:"onMouseDown",required:!1,type:{name:"(event: React.MouseEvent<HTMLInputElement, MouseEvent>) => void"}},disabled:{defaultValue:{value:"false"},description:"Whether or not the Favorite is disabled",name:"disabled",required:!1,type:{name:"boolean"}},customSize:{defaultValue:{value:"2.5rem"},description:"The size of the icon in rem or px, minimum size is 1.5rem / 24px",name:"customSize",required:!1,type:{name:"string"}}}}}catch{}const jt={title:"Components/Favorites/Favorites",component:E},Re=[{id:"123",pos:0,name:"App #1"},{id:"456",pos:0,name:"A retired app"},{id:"789",pos:0,name:"Another retired app"}],_={render:()=>l.jsx($,{client:new te({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),children:l.jsx(R,{children:Re.map(e=>l.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[l.jsx(E,{id:e.id,name:e.name,disabled:e.name.includes("retired")}),l.jsx("div",{children:e.name})]},e.id))})})};var q,L,N;_.parameters={..._.parameters,docs:{...(q=_.parameters)==null?void 0:q.docs,source:{originalSource:`{
  render: () => {
    return <QueryClientProvider client={new QueryClient({
      defaultOptions: {
        queries: {
          refetchOnWindowFocus: false
        }
      }
    })}>
        <FavoritesProvider>
          {storyFavorites.map(fav => <div style={{
          display: 'flex',
          gap: '1rem',
          alignItems: 'center'
        }} key={fav.id}>
              <FavoriteHeart id={fav.id} name={fav.name} disabled={fav.name.includes('retired')} />
              <div>{fav.name}</div>
            </div>)}
        </FavoritesProvider>
      </QueryClientProvider>;
  }
}`,...(N=(L=_.parameters)==null?void 0:L.docs)==null?void 0:N.source}}};const Dt=["_FavoriteHeart"];export{_ as _FavoriteHeart,Dt as __namedExportsOrder,jt as default};
