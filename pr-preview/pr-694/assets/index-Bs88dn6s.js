import{r as g}from"./index-DcWiA9TO.js";import{T as D}from"./index-Cy29Pico.js";import{S as z,b as M}from"./index-DS2qViMa.js";import{j as p}from"./jsx-runtime-CcL-W3nW.js";import{a as V,b as R,c as G}from"./index-CbnB3Kvf.js";import{A as B}from"./Autocomplete-DYfkOmMd.js";import{u as H}from"./useInfiniteQuery-BlwNwEaC.js";import{I as W}from"./IconButton-Caxu-qgA.js";import{C as Q}from"./CircularProgress-D8w9ZPs6.js";var $=Object.defineProperty,J=Object.defineProperties,U=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable,w=(t,e,o)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,n=(t,e)=>{for(var o in e||(e={}))A.call(e,o)&&w(t,o,e[o]);if(O)for(var o of O(e))L.call(e,o)&&w(t,o,e[o]);return t},i=(t,e)=>J(t,U(e)),y=(t,e)=>{var o={};for(var r in t)A.call(t,r)&&e.indexOf(r)<0&&(o[r]=t[r]);if(t!=null&&O)for(var r of O(t))e.indexOf(r)<0&&L.call(t,r)&&(o[r]=t[r]);return o},P=(t,e,o)=>new Promise((r,u)=>{var c=s=>{try{f(o.next(s))}catch(l){u(l)}},a=s=>{try{f(o.throw(s))}catch(l){u(l)}},f=s=>s.done?r(s.value):Promise.resolve(s.value).then(c,a);f((o=o.apply(t,e)).next())}),X=g.forwardRef((t,e)=>p.jsxs(p.Fragment,{children:[p.jsx(M,{orientation:"vertical",className:"MuiSelect-avEndAdornmentDivider"}),p.jsx(W,i(n({},t),{ref:e}))]})),Y={marginRight:".5rem"},Z=()=>p.jsx(Q,{"aria-label":"Loading",size:20,sx:Y}),k=t=>{var e=t,{FieldProps:o}=e,r=y(e,["FieldProps"]);const u={fullWidth:!0,size:"small"},c=a=>({InputProps:i(n(n({},a==null?void 0:a.InputProps),o==null?void 0:o.InputProps),{endAdornment:r.loading?p.jsxs(p.Fragment,{children:[(a==null?void 0:a.InputProps.endAdornment)||null,p.jsx(Z,{})]}):(a==null?void 0:a.InputProps.endAdornment)||null}),inputProps:i(n({},a==null?void 0:a.inputProps),{"aria-controls":(a==null?void 0:a.inputProps["aria-controls"])||""})});return p.jsx(B,n(n({renderInput:a=>p.jsx(D,n(n(n({},a),o),c(a))),popupIcon:p.jsx(z,{className:"MuiSelect-avExpandIcon"}),slotProps:{popupIndicator:{component:X}}},r),u))},ee=(t,e)=>{const[o,r]=g.useState("");return g.useEffect(()=>{const u=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(u)}},[t]),o},C=t=>{var e=t,{loadOptions:o,limit:r=50,queryKey:u,ListboxProps:c,queryOptions:a,watchParams:f,debounceTimeout:s=350,FieldProps:l,onInputChange:v}=e,h=y(e,["loadOptions","limit","queryKey","ListboxProps","queryOptions","watchParams","debounceTimeout","FieldProps","onInputChange"]);const[b,x]=g.useState(""),S=d=>{var m;x(d.target.value),(m=l==null?void 0:l.InputProps)!=null&&m.onChange&&l.InputProps.onChange(d)},j=ee(b,s),{isLoading:F,isFetching:q,data:I,hasNextPage:K,fetchNextPage:T}=H(n({queryKey:[u,r,j,f],queryFn:d=>P(void 0,[d],function*({pageParam:m=0}){return o(m,r,j)}),staleTime:1e4,getNextPageParam:d=>d.hasMore?d.offset+r:!1},a)),E=I!=null&&I.pages?I.pages.map(d=>d.options).flat():[],N=(d,m,_)=>{_==="clear"&&x(d.target.value),v&&v(d,m,_)};return p.jsx(k,i(n({},h),{onInputChange:N,FieldProps:i(n({},l),{InputProps:i(n({},l==null?void 0:l.InputProps),{onChange:S})}),loading:q,options:E,ListboxProps:i(n({},c),{onScroll:d=>P(void 0,null,function*(){const m=d.currentTarget;m.scrollHeight-(m.scrollTop+m.clientHeight)<=5&&!F&&!q&&K&&T()})})}))},te=t=>P(void 0,null,function*(){const e=yield V.query(t);return{options:e.data.codes,hasMore:t.params.offset+t.params.limit<e.data.totalCount,offset:t.params.offset}}),fe=t=>{var e=t,{apiConfig:o={},queryOptions:r,queryKey:u="codes-autocomplete",list:c,watchParams:a}=e,f=y(e,["apiConfig","queryOptions","queryKey","list","watchParams"]);const s=(v,h,b)=>P(void 0,null,function*(){return yield te(i(n({},o),{params:i(n({},o.params),{list:c,offset:v,limit:h,q:b})}))}),l=v=>[v.code,v.value].filter(Boolean).join(" - ");return p.jsx(C,i(n({getOptionLabel:l,queryKey:u,queryOptions:n({enabled:!!c},r),watchParams:n({list:c},a)},f),{loadOptions:s}))},oe=t=>P(void 0,null,function*(){const e=yield R.getOrganizations(t);return{options:e.data.organizations,hasMore:t.params.offset+t.params.limit<e.data.totalCount,offset:t.params.offset}}),me=t=>{var e=t,{apiConfig:o={},queryKey:r="org-autocomplete"}=e,u=y(e,["apiConfig","queryKey"]);const c=(f,s)=>P(void 0,null,function*(){return yield oe(i(n({},o),{params:i(n({dropdown:!0},o.params),{offset:f,limit:s})}))}),a=f=>f.name;return p.jsx(C,i(n({getOptionLabel:a,queryKey:r},u),{loadOptions:c}))},re=(t,e)=>P(void 0,null,function*(){const o=yield G.getProviders(t,e);return{options:o.data.providers,hasMore:e.params.offset+e.params.limit<o.data.totalCount,offset:e.params.offset}}),ve=t=>{var e=t,{apiConfig:o={},customerId:r,queryKey:u="prov-autocomplete"}=e,c=y(e,["apiConfig","customerId","queryKey"]);const a=(s,l,v)=>P(void 0,null,function*(){return yield re(r,i(n({},o),{params:i(n({},o.params),{offset:s,limit:l,q:v})}))}),f=s=>s.uiDisplayName;return p.jsx(C,i(n({getOptionLabel:f,queryOptions:{enabled:!!r},queryKey:u,watchParams:{customerId:r}},c),{loadOptions:a}))};export{k as A,fe as C,me as O,ve as P,C as a};
