import{j as u}from"./jsx-runtime-CcL-W3nW.js";import{r as m}from"./index-DcWiA9TO.js";import{s as A}from"./index-DMWJB0MK.js";import{d as W}from"./index-C5soOJ6z.js";import{u as J}from"./useQuery-D4UpBS0N.js";import{S as Z,I as Y,n as G,J as $,u as T,f as ee,K as te,i as re}from"./suspense-BqeUBMhm.js";import{g as ie,Q as se}from"./queryClient-CjDmLjqo.js";import{T as oe}from"./Tooltip-CiiaKkqp.js";import{g as q,q as I}from"./index-4AU0IlPL.js";import{C as ne}from"./index-CgN_Fp17.js";import{s as V}from"./styled-CF1hcdwO.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-uZUcOW5W.js";import"./___vite-browser-external_commonjs-proxy-DRaEfepn.js";import"./index-BXb5JWGK.js";import"./_toKey-MoF_TmUD.js";import"./useBaseQuery-CJ5trF24.js";import"./generateUtilityClass-CVWqFxsA.js";import"./identifier-Dtqimryx.js";import"./index-nos-0K8U.js";import"./useTheme-DUkCvbx_.js";import"./DefaultPropsProvider-_cNB_dWy.js";import"./useTheme-C2CrmYKc.js";import"./memoTheme-D-rVhYRp.js";import"./useSlot-DnkSxE3X.js";import"./resolveComponentProps-Dg20wxiM.js";import"./useForkRef-BVrIj09m.js";import"./generateUtilityClasses-BGOCnVj7.js";import"./useTimeout-B8wmcRZV.js";import"./useEnhancedEffect-D2f2tbda.js";import"./useControlled-WdbyInBW.js";import"./useId-DszduLV4.js";import"./getReactElementRef-AnOffBoZ.js";import"./Portal-CBAx_nZm.js";import"./utils-D5ZkK9XY.js";import"./objectWithoutPropertiesLoose-CAYKN5F1.js";import"./TransitionGroupContext-D-IBNIfW.js";import"./index-BEx9gAkE.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlotProps-BAIpVL6Y.js";import"./isFocusVisible-B8k4qzLc.js";import"./faCircleArrowRight-BeBmJtPK.js";import"./faUser-DXPB7Q64.js";import"./faSortDown-nq-jkck6.js";import"./SvgIcon-DSdWmKAH.js";import"./index-BtPDELIe.js";import"./Typography-CvSvtD2a.js";import"./index-f0Aa_BgU.js";import"./extendSxProp-B5AgUjQT.js";import"./emotion-react.browser.esm-CU7ej9d2.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./Stack-BcsM4Vc0.js";import"./styled-vBjI3IQc.js";import"./useThemeProps-BIK-1DKm.js";import"./CircularProgress-D8w9ZPs6.js";import"./LinearProgress-aFncvf6g.js";import"./Box-DWnb8VZB.js";class ae extends Z{constructor(t,r){super(),this.client=t,this.setOptions(r),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const i=this.options;this.options=this.client.defaultMutationOptions(t),Y(i,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),(r=this.currentMutation)==null||r.setOptions(this.options)}onUnsubscribe(){if(!this.hasListeners()){var t;(t=this.currentMutation)==null||t.removeObserver(this)}}onMutationUpdate(t){this.updateResult();const r={listeners:!0};t.type==="success"?r.onSuccess=!0:t.type==="error"&&(r.onError=!0),this.notify(r)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,r){return this.mutateOptions=r,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof t<"u"?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const t=this.currentMutation?this.currentMutation.state:ie(),r={...t,isLoading:t.status==="loading",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=r}notify(t){G.batch(()=>{if(this.mutateOptions&&this.hasListeners()){if(t.onSuccess){var r,i,o,s;(r=(i=this.mutateOptions).onSuccess)==null||r.call(i,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(o=(s=this.mutateOptions).onSettled)==null||o.call(s,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(t.onError){var n,d,a,p;(n=(d=this.mutateOptions).onError)==null||n.call(d,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(a=(p=this.mutateOptions).onSettled)==null||a.call(p,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}t.listeners&&this.listeners.forEach(({listener:f})=>{f(this.currentResult)})})}}function ue(e,t,r){const i=$(e,t,r),o=T({context:i.context}),[s]=m.useState(()=>new ae(o,i));m.useEffect(()=>{s.setOptions(i)},[s,i]);const n=ee(m.useCallback(a=>s.subscribe(G.batchCalls(a)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),d=m.useCallback((a,p)=>{s.mutate(a,p).catch(le)},[s]);if(n.error&&te(s.options.useErrorBoundary,[n.error]))throw n.error;return{...n,mutate:d,mutateAsync:n.mutate}}function le(){}var ce=Object.defineProperty,de=Object.defineProperties,pe=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,K=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,L=(e,t,r)=>t in e?ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ve=(e,t)=>{for(var r in t||(t={}))K.call(t,r)&&L(e,r,t[r]);if(E)for(var r of E(t))B.call(t,r)&&L(e,r,t[r]);return e},me=(e,t)=>de(e,pe(t)),fe=(e,t)=>{var r={};for(var i in e)K.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&E)for(var i of E(e))t.indexOf(i)<0&&B.call(e,i)&&(r[i]=e[i]);return r},he=e=>{const t=e,{children:r,dangerouslySetTransitionTimer:i}=t,o=fe(t,["children","dangerouslySetTransitionTimer"]);return u.jsx(oe,me(ve({},o),{TransitionProps:{timeout:i!==void 0?i:100},arrow:!0,children:r}))};const ye=60,O="Gateway-AvNavigation",R={FAVORITES_UPDATE:"av:favorites:update",FAVORITES_CHANGED:"av:favorites:changed",MAX_FAVORITES:"av:favorites:maxed"},Fe=e=>typeof(e==null?void 0:e.id)=="string"&&typeof(e==null?void 0:e.pos)=="number",be=e=>Array.isArray(e)?e==null?void 0:e.filter(Fe):[],ge=async({favorites:e,targetFavoriteId:t},r)=>({favorites:(await W.setApplication(r,{favorites:e})).data.favorites,targetFavoriteId:t}),_e=async e=>{var o,s,n;const t=await W.getApplication(e),r=(n=(s=(o=t==null?void 0:t.data)==null?void 0:o.settings)==null?void 0:s[0])==null?void 0:n.favorites;return be(r)},xe=(e,t)=>J(["favorites"],()=>_e(t),{enabled:e}),we=({onMutationStart:e},t)=>{const r=T(),{mutateAsync:i,...o}=ue(({favorites:s,targetFavoriteId:n})=>ge({favorites:s,targetFavoriteId:n},t),{onMutate(s){e==null||e(s.targetFavoriteId)},onSuccess(s){r.setQueryData(["favorites"],s.favorites)}});return{submitFavorites:i,...o}},N=(e,t)=>{t===O&&A.send({favorites:e,event:R.FAVORITES_UPDATE})},Se=e=>e===O?A.send(R.MAX_FAVORITES):null,X=m.createContext(null),H=({children:e,onFavoritesChange:t,onMaxFavoritesReached:r,settingsFavorites:i,settingsStatus:o,applicationId:s=O,maxFavorites:n=ye})=>{const[d,a]=m.useState(""),p=T(),{data:f,status:_}=xe(!o,s),l=o?i:f,x=o||_,{submitFavorites:F,status:w}=we({onMutationStart(v){a(v)}},s);m.useEffect(()=>{if(s===O){const v=A.subscribe(R.FAVORITES_CHANGED,c=>{c!=null&&c.favorites&&p.setQueryData(["favorites"],c==null?void 0:c.favorites)},{ignoreSameWindow:!1}),y=A.subscribe(R.FAVORITES_UPDATE,c=>{c!=null&&c.favorites&&p.setQueryData(["favorites"],c==null?void 0:c.favorites)},{ignoreSameWindow:!1});return()=>{v(),y()}}return()=>null},[p,s]);const b=async v=>{if(l){const y=await F({favorites:l.filter(c=>c.id!==v),targetFavoriteId:v});N(y.favorites,s),t==null||t(y.favorites)}},h=async v=>{if(!l)return!1;if(l.length>=n)return Se(s),r&&typeof r=="function"&&await r(l),!1;const y=l.reduce((g,C)=>((!g||C.pos>g.pos)&&(g=C),g),null),c=y?y.pos+1:0,P=await F({favorites:[...l,{id:v,pos:c}],targetFavoriteId:v});return N(P.favorites,s),t==null||t(P.favorites),!!P.favorites.find(g=>g.id===v)};return u.jsx(X.Provider,{value:{favorites:l,queryStatus:x,mutationStatus:w,lastClickedFavoriteId:d,deleteFavorite:b,addFavorite:h},children:e})},Ae=()=>{},j=e=>{const t=m.useContext(X);if(t===null)throw new Error("useFavorites must be used within a FavoritesProvider");const{favorites:r,queryStatus:i,mutationStatus:o,lastClickedFavoriteId:s,deleteFavorite:n,addFavorite:d}=t,a=s===e,p=m.useMemo(()=>!!(r==null?void 0:r.find(F=>F.id===e)),[r,e]),f=()=>p?n(e):d(e),_=i==="loading"||i==="idle"||o==="loading";let l="initLoading";return i==="loading"&&(l="initLoading"),i==="reloading"&&(l="reloading"),o==="loading"&&(l="reloading"),(i==="error"||o==="error")&&(l="error"),i==="success"&&(o==="success"||o==="idle")&&(l="success"),{isFavorited:p,status:l,isLastClickedFavorite:a,toggleFavorite:_?Ae:f}};try{H.displayName="FavoritesProvider",H.__docgenInfo={description:"",displayName:"FavoritesProvider",props:{onFavoritesChange:{defaultValue:null,description:"",name:"onFavoritesChange",required:!1,type:{name:"(favorites: Favorite[]) => void"}},onMaxFavoritesReached:{defaultValue:null,description:"",name:"onMaxFavoritesReached",required:!1,type:{name:"(favorites: Favorite[]) => void"}},settingsFavorites:{defaultValue:null,description:"",name:"settingsFavorites",required:!1,type:{name:"Favorite[]"}},settingsStatus:{defaultValue:null,description:"",name:"settingsStatus",required:!1,type:{name:"StatusUnion"}},applicationId:{defaultValue:{value:"Gateway-AvNavigation"},description:"",name:"applicationId",required:!1,type:{name:"string"}},maxFavorites:{defaultValue:{value:"60"},description:"",name:"maxFavorites",required:!1,type:{name:"number"}}}}}catch{}try{j.displayName="useFavorites",j.__docgenInfo={description:"",displayName:"useFavorites",props:{}}}catch{}const Ee={spinner:u.jsx(ne,{"aria-hidden":!0,size:"small",loadingCaption:!1}),unknownDisabledHeart:u.jsx(I,{"aria-hidden":!0,color:"disabled"}),favoritedDisabledHeart:u.jsx(I,{"aria-hidden":!0,color:"error",opacity:"0.6"}),unfavoritedDisabledHeart:u.jsx(q,{"aria-hidden":!0,color:"disabled",opacity:"0.6"}),favoritedHeart:u.jsx(I,{"aria-hidden":!0,color:"error"}),unfavoritedHeart:u.jsx(q,{"aria-hidden":!0,color:"secondary"})},D="2.5rem",Oe=V("div",{name:"AvFavoriteHeart",slot:"Root"})(({customSize:e})=>({height:e,width:e})),k=V("input",{name:"AvFavoriteHeart",slot:"input"})(({customSize:e})=>({height:e,width:e,minHeight:e,minWidth:e})),Re=(e=D)=>{const t=e.match(/^(\d*\.?\d+)(px|rem)$/);if(!t)throw new Error("Invalid size format. Must be in 'px' or 'rem'.");const[,r,i]=t;return`${parseFloat(r)/2}${i}`},Me=V("div",{name:"AvFavoriteHeart",slot:"icon"})(({customSize:e})=>({fontSize:Re(e)})),Pe=e=>{const t=e.match(/^(\d*\.?\d+)(px|rem)$/);if(!t)return!1;const[,r,i]=t,o=parseFloat(r);return i==="rem"&&o>=1.5?!0:i==="px"&&o>=24},M=({id:e,name:t,onChange:r,onMouseDown:i,disabled:o=!1,customSize:s=D})=>{const{isFavorited:n,isLastClickedFavorite:d,status:a,toggleFavorite:p}=j(e),f=h=>{r==null||r(n,h),p()},_=h=>{(h.code==="Enter"||h.key==="Enter")&&(r==null||r(n,h),p())},l=a==="initLoading"?"unknownDisabledHeart":a==="reloading"?d?"spinner":n?"favoritedDisabledHeart":"unfavoritedDisabledHeart":o?n?"favoritedDisabledHeart":"unfavoritedDisabledHeart":n?"favoritedHeart":"unfavoritedHeart",x=o||!d&&(a==="initLoading"||a==="reloading")?"not-allowed":void 0,F=`${n?"Remove from":"Add to"} My Favorites`,w={onKeyDown:_,type:"checkbox","aria-label":`Favorite ${t}`,id:`av-favorite-heart-${e}`,disabled:o,checked:n,onChange:f,onMouseDown:i,style:{cursor:x}},b=Pe(s)?s:D;return u.jsxs(Oe,{customSize:b,children:[u.jsx(Me,{customSize:b,children:Ee[l]}),u.jsx("span",{style:{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},"aria-live":d&&(a==="reloading"||a==="error")?"polite":"off",children:d&&a==="reloading"?"Loading...":d&&a==="error"?"An error has occurred. Please try again.":""}),o?u.jsx(k,{customSize:b,...w}):u.jsx(he,{title:F,placement:"top",children:u.jsx(k,{customSize:b,...w})})]})};try{M.displayName="FavoriteHeart",M.__docgenInfo={description:"",displayName:"FavoriteHeart",props:{id:{defaultValue:null,description:"The configuration's id",name:"id",required:!0,type:{name:"string"}},name:{defaultValue:null,description:"The name of the configuration",name:"name",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"What to do on Favorite Toggle",name:"onChange",required:!1,type:{name:"(isFavorited: boolean, event: any) => void"}},onMouseDown:{defaultValue:null,description:"What to do on click",name:"onMouseDown",required:!1,type:{name:"(event: React.MouseEvent<HTMLInputElement, MouseEvent>) => void"}},disabled:{defaultValue:{value:"false"},description:"Whether or not the Favorite is disabled",name:"disabled",required:!1,type:{name:"boolean"}},customSize:{defaultValue:{value:"2.5rem"},description:"The size of the icon in rem or px, minimum size is 1.5rem / 24px",name:"customSize",required:!1,type:{name:"string"}}}}}catch{}const Vt={title:"Components/Favorites/Favorites",component:M},Ie=[{id:"123",pos:0,name:"App #1"},{id:"456",pos:0,name:"A retired app"},{id:"789",pos:0,name:"Another retired app"}],S={render:()=>u.jsx(re,{client:new se({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),children:u.jsx(H,{children:Ie.map(e=>u.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[u.jsx(M,{id:e.id,name:e.name,disabled:e.name.includes("retired")}),u.jsx("div",{children:e.name})]},e.id))})})};var Q,U,z;S.parameters={...S.parameters,docs:{...(Q=S.parameters)==null?void 0:Q.docs,source:{originalSource:`{
  render: () => {
    return <QueryClientProvider client={new QueryClient({
      defaultOptions: {
        queries: {
          refetchOnWindowFocus: false
        }
      }
    })}>
        <FavoritesProvider>
          {storyFavorites.map(fav => <div style={{
          display: 'flex',
          gap: '1rem',
          alignItems: 'center'
        }} key={fav.id}>
              <FavoriteHeart id={fav.id} name={fav.name} disabled={fav.name.includes('retired')} />
              <div>{fav.name}</div>
            </div>)}
        </FavoritesProvider>
      </QueryClientProvider>;
  }
}`,...(z=(U=S.parameters)==null?void 0:U.docs)==null?void 0:z.source}}};const Ct=["_FavoriteHeart"];export{S as _FavoriteHeart,Ct as __namedExportsOrder,Vt as default};
