import{r as p,j as u}from"./iframe-BRLvBxWA.js";import{i as w}from"./index-BiBDMnSv.js";import{d as k}from"./index-w7AR0bee.js";import{u as z}from"./useQuery-DLA0VJjB.js";import{S as W,F as G,n as Q,G as B,u as j,f as K,H as X,Q as Z}from"./suspense-CS4iARp7.js";import{g as J,Q as Y}from"./queryClient-FEU5_vHL.js";import{T as $}from"./index-DJ5glQvL.js";import{h as q,p as I}from"./index-XiudsVJB.js";import{C as ee}from"./index-CuYOtL15.js";import{s as P}from"./styled-CZ9R0hiM.js";import"./preload-helper-PPVm8Dsz.js";import"./index-CmbtDME2.js";import"./___vite-browser-external_commonjs-proxy-Bt1cZCQw.js";import"./index-D1GAEzwN.js";import"./_toKey-BtcDnGvm.js";import"./useBaseQuery-Bl4CXGOk.js";import"./infiniteQueryBehavior-BTtYVWpE.js";import"./Tooltip-7V2d6kcs.js";import"./useTheme-DUDwCCgT.js";import"./memoTheme-KNjPhf5l.js";import"./useSlot-BL0V4ya8.js";import"./mergeSlotProps-DJQ_9vH6.js";import"./useForkRef-Btt9MVeC.js";import"./generateUtilityClasses-DDbjFgb8.js";import"./generateUtilityClass-BtcU_pBl.js";import"./useTimeout-D2Y7qDK0.js";import"./useControlled-APkh1ier.js";import"./useEventCallback-8VD7KoTy.js";import"./getReactElementRef-Cit-YTyg.js";import"./Portal-B3jPIhjh.js";import"./utils-v3JDOV4B.js";import"./TransitionGroupContext-DVVrop_G.js";import"./ownerDocument-DW-IO8s5.js";import"./useSlotProps-BzYpEyJr.js";import"./isFocusVisible-B8k4qzLc.js";import"./faCircleArrowRight-Bwu2D-Ak.js";import"./faUser-wrn0edYp.js";import"./SvgIcon-Ddzah0KZ.js";import"./index-qy36QUxT.js";import"./Typography-CYuHQB7d.js";import"./createSimplePaletteValueFilter-bm0fmN_7.js";import"./Stack-ng3wJJZp.js";import"./styled-tPTq9LI3.js";import"./CircularProgress-gYkLYLdu.js";import"./LinearProgress-CKWtDpgr.js";import"./Box-zm6tG-Ly.js";class te extends W{constructor(t,r){super(),this.client=t,this.setOptions(r),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const i=this.options;this.options=this.client.defaultMutationOptions(t),G(i,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),(r=this.currentMutation)==null||r.setOptions(this.options)}onUnsubscribe(){if(!this.hasListeners()){var t;(t=this.currentMutation)==null||t.removeObserver(this)}}onMutationUpdate(t){this.updateResult();const r={listeners:!0};t.type==="success"?r.onSuccess=!0:t.type==="error"&&(r.onError=!0),this.notify(r)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,r){return this.mutateOptions=r,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof t<"u"?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const t=this.currentMutation?this.currentMutation.state:J(),r=t.status==="loading",i={...t,isLoading:r,isPending:r,isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=i}notify(t){Q.batch(()=>{if(this.mutateOptions&&this.hasListeners()){if(t.onSuccess){var r,i,o,s;(r=(i=this.mutateOptions).onSuccess)==null||r.call(i,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(o=(s=this.mutateOptions).onSettled)==null||o.call(s,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(t.onError){var a,d,n,c;(a=(d=this.mutateOptions).onError)==null||a.call(d,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(n=(c=this.mutateOptions).onSettled)==null||n.call(c,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}t.listeners&&this.listeners.forEach(({listener:m})=>{m(this.currentResult)})})}}function re(e,t,r){const i=B(e,t,r),o=j({context:i.context}),[s]=p.useState(()=>new te(o,i));p.useEffect(()=>{s.setOptions(i)},[s,i]);const a=K(p.useCallback(n=>s.subscribe(Q.batchCalls(n)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),d=p.useCallback((n,c)=>{s.mutate(n,c).catch(ie)},[s]);if(a.error&&X(s.options.useErrorBoundary,[a.error]))throw a.error;return{...a,mutate:d,mutateAsync:a.mutate}}function ie(){}const se=60,R="Gateway-AvNavigation",_={FAVORITES_UPDATE:"av:favorites:update",FAVORITES_CHANGED:"av:favorites:changed",MAX_FAVORITES:"av:favorites:maxed"},oe=e=>typeof e?.id=="string"&&typeof e?.pos=="number",ae=e=>Array.isArray(e)?e?.filter(oe):[],ne=async({favorites:e,targetFavoriteId:t},r)=>({favorites:(await k.setApplication(r,{favorites:e})).data.favorites,targetFavoriteId:t}),ue=async e=>{const r=(await k.getApplication(e))?.data?.settings?.[0]?.favorites;return ae(r)},le=(e,t)=>z(["favorites"],()=>ue(t),{enabled:e}),de=({onMutationStart:e},t)=>{const r=j(),{mutateAsync:i,...o}=re(({favorites:s,targetFavoriteId:a})=>ne({favorites:s,targetFavoriteId:a},t),{onMutate(s){e?.(s.targetFavoriteId)},onSuccess(s){r.setQueryData(["favorites"],s.favorites)}});return{submitFavorites:i,...o}},L=(e,t)=>{t===R&&w.send({favorites:e,event:_.FAVORITES_UPDATE})},ce=e=>e===R?w.send(_.MAX_FAVORITES):null,U=p.createContext(null),O=({children:e,onFavoritesChange:t,onMaxFavoritesReached:r,settingsFavorites:i,settingsStatus:o,applicationId:s=R,maxFavorites:a=se})=>{const[d,n]=p.useState(""),c=j(),{data:m,status:x}=le(!o,s),l=o?i:m,C=o||x,{submitFavorites:F,status:E}=de({onMutationStart(v){n(v)}},s);p.useEffect(()=>{const f=(()=>{if(s===R){const S=w.subscribe(_.FAVORITES_CHANGED,g=>{g?.favorites&&c.setQueryData(["favorites"],g?.favorites)},{ignoreSameWindow:!1}),A=w.subscribe(_.FAVORITES_UPDATE,g=>{g?.favorites&&c.setQueryData(["favorites"],g?.favorites)},{ignoreSameWindow:!1});return()=>{S(),A()}}})();return()=>{f&&f()}},[c,s]);const y=async v=>{if(l){const f=await F({favorites:l.filter(S=>S.id!==v),targetFavoriteId:v});L(f.favorites,s),t?.(f.favorites)}},h=async v=>{if(!l)return!1;if(l.length>=a)return ce(s),r&&typeof r=="function"&&await r(l),!1;const f=l.reduce((b,T)=>((!b||T.pos>b.pos)&&(b=T),b),null),S=f?f.pos+1:0,A=await F({favorites:[...l,{id:v,pos:S}],targetFavoriteId:v});return L(A.favorites,s),t?.(A.favorites),!!A.favorites.find(b=>b.id===v)};return u.jsx(U.Provider,{value:{favorites:l,queryStatus:C,mutationStatus:E,lastClickedFavoriteId:d,deleteFavorite:y,addFavorite:h},children:e})},ve=()=>{},D=e=>{const t=p.useContext(U);if(t===null)throw new Error("useFavorites must be used within a FavoritesProvider");const{favorites:r,queryStatus:i,mutationStatus:o,lastClickedFavoriteId:s,deleteFavorite:a,addFavorite:d}=t,n=s===e,c=p.useMemo(()=>!!r?.find(F=>F.id===e),[r,e]),m=()=>c?a(e):d(e),x=i==="loading"||i==="idle"||o==="loading";let l="initLoading";return i==="loading"&&(l="initLoading"),i==="reloading"&&(l="reloading"),o==="loading"&&(l="reloading"),(i==="error"||o==="error")&&(l="error"),i==="success"&&(o==="success"||o==="idle")&&(l="success"),{isFavorited:c,status:l,isLastClickedFavorite:n,toggleFavorite:x?ve:m}};try{O.displayName="FavoritesProvider",O.__docgenInfo={description:"",displayName:"FavoritesProvider",props:{onFavoritesChange:{defaultValue:null,description:"",name:"onFavoritesChange",required:!1,type:{name:"(favorites: Favorite[]) => void"}},onMaxFavoritesReached:{defaultValue:null,description:"",name:"onMaxFavoritesReached",required:!1,type:{name:"(favorites: Favorite[]) => void"}},settingsFavorites:{defaultValue:null,description:"",name:"settingsFavorites",required:!1,type:{name:"Favorite[]"}},settingsStatus:{defaultValue:null,description:"",name:"settingsStatus",required:!1,type:{name:"StatusUnion"}},applicationId:{defaultValue:{value:"Gateway-AvNavigation"},description:"",name:"applicationId",required:!1,type:{name:"string"}},maxFavorites:{defaultValue:{value:"60"},description:"",name:"maxFavorites",required:!1,type:{name:"number"}}}}}catch{}try{D.displayName="useFavorites",D.__docgenInfo={description:"",displayName:"useFavorites",props:{}}}catch{}const pe={spinner:u.jsx(ee,{"aria-hidden":!0,size:"small",loadingCaption:!1}),unknownDisabledHeart:u.jsx(I,{"aria-hidden":!0,color:"disabled"}),favoritedDisabledHeart:u.jsx(I,{"aria-hidden":!0,color:"error",opacity:"0.6"}),unfavoritedDisabledHeart:u.jsx(q,{"aria-hidden":!0,color:"disabled",opacity:"0.6"}),favoritedHeart:u.jsx(I,{"aria-hidden":!0,color:"error"}),unfavoritedHeart:u.jsx(q,{"aria-hidden":!0,color:"secondary"})},V="2.5rem",fe=P("div",{name:"AvFavoriteHeart",slot:"Root"})(({customSize:e})=>({height:e,width:e})),N=P("input",{name:"AvFavoriteHeart",slot:"input"})(({customSize:e})=>({height:e,width:e,minHeight:e,minWidth:e})),me=(e=V)=>{const t=e.match(/^(\d*\.?\d+)(px|rem)$/);if(!t)throw new Error("Invalid size format. Must be in 'px' or 'rem'.");const[,r,i]=t;return`${parseFloat(r)/2}${i}`},he=P("div",{name:"AvFavoriteHeart",slot:"icon"})(({customSize:e})=>({fontSize:me(e)})),Fe=e=>{const t=e.match(/^(\d*\.?\d+)(px|rem)$/);if(!t)return!1;const[,r,i]=t,o=parseFloat(r);return i==="rem"&&o>=1.5?!0:i==="px"&&o>=24},H=({id:e,name:t,onChange:r,onMouseDown:i,disabled:o=!1,customSize:s=V})=>{const{isFavorited:a,isLastClickedFavorite:d,status:n,toggleFavorite:c}=D(e),m=h=>{r?.(a,h),c()},x=h=>{(h.code==="Enter"||h.key==="Enter")&&(r?.(a,h),c())},l=n==="initLoading"?"unknownDisabledHeart":n==="reloading"?d?"spinner":a?"favoritedDisabledHeart":"unfavoritedDisabledHeart":o?a?"favoritedDisabledHeart":"unfavoritedDisabledHeart":a?"favoritedHeart":"unfavoritedHeart",C=o||!d&&(n==="initLoading"||n==="reloading")?"not-allowed":void 0,F=`${a?"Remove from":"Add to"} My Favorites`,E={onKeyDown:x,type:"checkbox","aria-label":`Favorite ${t}`,id:`av-favorite-heart-${e}`,disabled:o,checked:a,onChange:m,onMouseDown:i,style:{cursor:C}},y=Fe(s)?s:V;return u.jsxs(fe,{customSize:y,children:[u.jsx(he,{customSize:y,children:pe[l]}),u.jsx("span",{style:{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},"aria-live":d&&(n==="reloading"||n==="error")?"polite":"off",children:d&&n==="reloading"?"Loading...":d&&n==="error"?"An error has occurred. Please try again.":""}),o?u.jsx(N,{customSize:y,...E}):u.jsx($,{title:F,placement:"top",children:u.jsx(N,{customSize:y,...E})})]})};try{H.displayName="FavoriteHeart",H.__docgenInfo={description:"",displayName:"FavoriteHeart",props:{id:{defaultValue:null,description:"The configuration's id",name:"id",required:!0,type:{name:"string"}},name:{defaultValue:null,description:"The name of the configuration",name:"name",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"What to do on Favorite Toggle",name:"onChange",required:!1,type:{name:"(isFavorited: boolean, event: any) => void"}},onMouseDown:{defaultValue:null,description:"What to do on click",name:"onMouseDown",required:!1,type:{name:"(event: React.MouseEvent<HTMLInputElement, MouseEvent>) => void"}},disabled:{defaultValue:{value:"false"},description:"Whether or not the Favorite is disabled",name:"disabled",required:!1,type:{name:"boolean"}},customSize:{defaultValue:{value:"2.5rem"},description:"The size of the icon in rem or px, minimum size is 1.5rem / 24px",name:"customSize",required:!1,type:{name:"string"}}}}}catch{}const ct={title:"Components/Favorites/Favorites",component:H},ye=[{id:"123",pos:0,name:"App #1"},{id:"456",pos:0,name:"A retired app"},{id:"789",pos:0,name:"Another retired app"}],M={render:()=>u.jsx(Z,{client:new Y({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),children:u.jsx(O,{children:ye.map(e=>u.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[u.jsx(H,{id:e.id,name:e.name,disabled:e.name.includes("retired")}),u.jsx("div",{children:e.name})]},e.id))})})};M.parameters={...M.parameters,docs:{...M.parameters?.docs,source:{originalSource:`{
  render: () => {
    return <QueryClientProvider client={new QueryClient({
      defaultOptions: {
        queries: {
          refetchOnWindowFocus: false
        }
      }
    })}>
        <FavoritesProvider>
          {storyFavorites.map(fav => <div style={{
          display: 'flex',
          gap: '1rem',
          alignItems: 'center'
        }} key={fav.id}>
              <FavoriteHeart id={fav.id} name={fav.name} disabled={fav.name.includes('retired')} />
              <div>{fav.name}</div>
            </div>)}
        </FavoritesProvider>
      </QueryClientProvider>;
  }
}`,...M.parameters?.docs?.source}}};const vt=["_FavoriteHeart"];export{M as _FavoriteHeart,vt as __namedExportsOrder,ct as default};
