import{r as O}from"./index-DcWiA9TO.js";import{T}from"./index-CbKWB2wV.js";import{S as E,a as N}from"./index-76YN4ACh.js";import{j as p}from"./jsx-runtime-CcL-W3nW.js";import{a as D,b as z,c as M}from"./index-Cs70mkZF.js";import{A as V}from"./Autocomplete-DlvytMGW.js";import{u as R}from"./useInfiniteQuery-BlwNwEaC.js";import{I as G}from"./IconButton-v3cBwN0V.js";import{C as B}from"./CircularProgress-BHFEuwTi.js";var H=Object.defineProperty,W=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,C=(t,e,o)=>e in t?H(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,a=(t,e)=>{for(var o in e||(e={}))w.call(e,o)&&C(t,o,e[o]);if(g)for(var o of g(e))A.call(e,o)&&C(t,o,e[o]);return t},i=(t,e)=>W(t,Q(e)),y=(t,e)=>{var o={};for(var r in t)w.call(t,r)&&e.indexOf(r)<0&&(o[r]=t[r]);if(t!=null&&g)for(var r of g(t))e.indexOf(r)<0&&A.call(t,r)&&(o[r]=t[r]);return o},P=(t,e,o)=>new Promise((r,u)=>{var d=s=>{try{c(o.next(s))}catch(l){u(l)}},n=s=>{try{c(o.throw(s))}catch(l){u(l)}},c=s=>s.done?r(s.value):Promise.resolve(s.value).then(d,n);c((o=o.apply(t,e)).next())}),$=O.forwardRef((t,e)=>p.jsxs(p.Fragment,{children:[p.jsx(N,{orientation:"vertical",className:"MuiSelect-avEndAdornmentDivider"}),p.jsx(G,i(a({},t),{ref:e}))]})),J={marginRight:".5rem"},U=()=>p.jsx(B,{"aria-label":"Loading",size:20,sx:J}),X=t=>{var e=t,{FieldProps:o}=e,r=y(e,["FieldProps"]);const u={fullWidth:!0,size:"small"},d=n=>({InputProps:i(a(a({},o==null?void 0:o.InputProps),n==null?void 0:n.InputProps),{endAdornment:r.loading?p.jsxs(p.Fragment,{children:[(n==null?void 0:n.InputProps.endAdornment)||null,p.jsx(U,{})]}):(n==null?void 0:n.InputProps.endAdornment)||null}),inputProps:i(a({},n==null?void 0:n.inputProps),{"aria-controls":(n==null?void 0:n.inputProps["aria-controls"])||""})});return p.jsx(V,a(a({renderInput:n=>p.jsx(T,a(a(a({},n),o),d(n))),popupIcon:p.jsx(E,{className:"MuiSelect-avExpandIcon"}),slotProps:{popupIndicator:{component:$}}},r),u))},Y=(t,e)=>{const[o,r]=O.useState("");return O.useEffect(()=>{const u=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(u)}},[t]),o},_=t=>{var e=t,{loadOptions:o,limit:r=50,queryKey:u,ListboxProps:d,queryOptions:n,watchParams:c,debounceTimeout:s=350,FieldProps:l}=e,m=y(e,["loadOptions","limit","queryKey","ListboxProps","queryOptions","watchParams","debounceTimeout","FieldProps"]);const[h,b]=O.useState(""),I=f=>{var v;b(f.target.value),(v=l==null?void 0:l.InputProps)!=null&&v.onChange&&l.InputProps.onChange(f)},j=Y(h,s),{isLoading:L,isFetching:q,data:x,hasNextPage:S,fetchNextPage:F}=R(a({queryKey:[u,r,j,c],queryFn:f=>P(void 0,[f],function*({pageParam:v=0}){return o(v,r,j)}),staleTime:1e4,getNextPageParam:f=>f.hasMore?f.offset+r:!1},n)),K=x!=null&&x.pages?x.pages.map(f=>f.options).flat():[];return p.jsx(X,i(a({},m),{FieldProps:i(a({},l),{InputProps:i(a({},l==null?void 0:l.InputProps),{onChange:I})}),loading:q,options:K,ListboxProps:i(a({},d),{onScroll:f=>P(void 0,null,function*(){const v=f.currentTarget;v.scrollHeight-(v.scrollTop+v.clientHeight)<=5&&!L&&!q&&S&&F()})})}))},Z=t=>P(void 0,null,function*(){const e=yield D.query(t);return{options:e.data.codes,hasMore:t.params.offset+t.params.limit<e.data.totalCount,offset:t.params.offset}}),de=t=>{var e=t,{apiConfig:o={},queryOptions:r,queryKey:u="codes-autocomplete",list:d,watchParams:n}=e,c=y(e,["apiConfig","queryOptions","queryKey","list","watchParams"]);const s=(m,h,b)=>P(void 0,null,function*(){return yield Z(i(a({},o),{params:i(a({},o.params),{list:d,offset:m,limit:h,q:b})}))}),l=m=>[m.code,m.value].filter(Boolean).join(" - ");return p.jsx(_,i(a({getOptionLabel:l,queryKey:u,queryOptions:a({enabled:!!d},r),watchParams:a({list:d},n)},c),{loadOptions:s}))},k=t=>P(void 0,null,function*(){const e=yield z.getOrganizations(t);return{options:e.data.organizations,hasMore:t.params.offset+t.params.limit<e.data.totalCount,offset:t.params.offset}}),ce=t=>{var e=t,{apiConfig:o={},queryKey:r="org-autocomplete"}=e,u=y(e,["apiConfig","queryKey"]);const d=(c,s)=>P(void 0,null,function*(){return yield k(i(a({},o),{params:i(a({dropdown:!0},o.params),{offset:c,limit:s})}))}),n=c=>c.name;return p.jsx(_,i(a({getOptionLabel:n,queryKey:r},u),{loadOptions:d}))},ee=(t,e)=>P(void 0,null,function*(){const o=yield M.getProviders(t,e);return{options:o.data.providers,hasMore:e.params.offset+e.params.limit<o.data.totalCount,offset:e.params.offset}}),fe=t=>{var e=t,{apiConfig:o={},customerId:r,queryKey:u="prov-autocomplete"}=e,d=y(e,["apiConfig","customerId","queryKey"]);const n=(s,l,m)=>P(void 0,null,function*(){return yield ee(r,i(a({},o),{params:i(a({},o.params),{offset:s,limit:l,q:m})}))}),c=s=>s.uiDisplayName;return p.jsx(_,i(a({getOptionLabel:c,queryOptions:{enabled:!!r},queryKey:u,watchParams:{customerId:r}},d),{loadOptions:n}))};export{_ as A,de as C,ce as O,fe as P,X as a};
