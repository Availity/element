{"version":3,"file":"Feedback.stories-bded37bb.js","sources":["../../../packages/feedback/src/lib/FeedbackForm.tsx","../../../packages/feedback/src/lib/FeedbackHeader.tsx","../../../packages/feedback/src/lib/Feedback.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { TextField } from '@availity/mui-textfield';\nimport { LoadingButton, Button } from '@availity/mui-button';\nimport { ToggleButtonGroup, ToggleButton } from '@availity/mui-toggle-button';\nimport { Grid, SvgIconProps, ToggleButtonProps, styled } from '@mui/material';\nimport { FaceFrownIcon, FaceNeutralIcon, FaceSmileIcon } from '@availity/mui-icon';\nimport { FormLabel } from '@availity/mui-form-utils';\nimport { avRegionsApi } from '@availity/api-axios';\nimport { useForm, SubmitHandler, Controller } from 'react-hook-form';\n\ninterface Inputs {\n  feedback: string;\n  smileField: string;\n}\n\ninterface SmileButtonProps extends ToggleButtonProps {\n  disabled: boolean;\n  Icon: (props: SvgIconProps) => JSX.Element;\n  label: string;\n  value: string;\n}\n\ninterface FeedbackFormProps {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  analytics: { info: (entries: Record<string, unknown>) => any };\n  appName: string;\n  handleClose: () => void;\n  loading: boolean;\n  sent: boolean;\n  setLoading: React.Dispatch<React.SetStateAction<boolean>>;\n  setSent: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst SmileButtons = styled(ToggleButtonGroup, { name: 'AvFeedbackContainer', slot: 'SmileButtons' })({});\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst SmileButton = ({ disabled, Icon, label, value, ...props }: SmileButtonProps) => (\n  <div>\n    <ToggleButton aria-label={value} value={value} {...props} disabled={disabled}>\n      <Icon fontSize=\"large\" />\n    </ToggleButton>\n  </div>\n);\n\nexport const FeedbackForm = ({\n  analytics,\n  appName,\n  handleClose,\n  loading,\n  sent,\n  setLoading,\n  setSent,\n}: FeedbackFormProps): JSX.Element | null => {\n  const {\n    control,\n    formState: { errors },\n    handleSubmit,\n    register,\n    setValue,\n    watch,\n  } = useForm<Inputs>();\n\n  const onSubmit: SubmitHandler<Inputs> = async ({ smileField, ...values }) => {\n    setLoading(true);\n    try {\n      const response = await avRegionsApi.getCurrentRegion();\n\n      await analytics.info({\n        surveyId: `${appName.replace(/\\s/g, '_')}_Smile_Survey`,\n        smileLocation: `${appName}`,\n        smile: `icon-${smileField}`,\n        url: window.location.href,\n        region: response.data.regions[0] && response.data.regions[0].id,\n        userAgent: window.navigator.userAgent,\n        submitTime: new Date(),\n        ...values, // Spread the form values onto the logger\n      });\n      setSent(true);\n      setLoading(false);\n    } catch {\n      setSent(false);\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (sent) {\n      setTimeout(() => {\n        handleClose();\n      }, 2000);\n    }\n  }, [sent]);\n\n  const options = [\n    {\n      Icon: FaceSmileIcon,\n      label: 'What do you like?',\n      value: 'smile',\n    },\n    {\n      Icon: FaceNeutralIcon,\n      label: 'What would you improve?',\n      value: 'meh',\n    },\n    { Icon: FaceFrownIcon, label: \"What don't you like?\", value: 'frown' },\n  ];\n\n  const smileFieldValue = watch('smileField');\n\n  const getFeedbackLabel = () => {\n    const option = options.find((option) => option.value === smileFieldValue);\n\n    return option?.label || 'What would you improve?';\n  };\n\n  if (!sent) {\n    return (\n      <Grid\n        component=\"form\"\n        container\n        justifyContent=\"center\"\n        onSubmit={handleSubmit(onSubmit)}\n        aria-label=\"Feedback Form\"\n        aria-describedby=\"feedback-form-header\"\n      >\n        <Controller\n          control={control}\n          name=\"smileField\"\n          render={({ field }) => {\n            return (\n              <SmileButtons\n                children={options.map((props, index) => (\n                  <SmileButton autoFocus={index === 0} disabled={loading} key={props.value} {...props} />\n                ))}\n                {...field}\n                aria-labelledby=\"feedback-form-header\"\n                onChange={(event: React.MouseEvent<HTMLElement>, value: string) => {\n                  setValue(field.name, value);\n                }}\n                size=\"medium\"\n                exclusive\n              />\n            );\n          }}\n        />\n        {smileFieldValue && (\n          <TextField\n            {...register('feedback', {\n              required: 'This field is required',\n              maxLength: { value: 200, message: 'This field must not exceed 200 characters' },\n            })}\n            fullWidth\n            multiline\n            minRows={3}\n            maxRows={3}\n            label={getFeedbackLabel()}\n            inputProps={{ 'aria-required': 'true' }}\n            InputLabelProps={{\n              component: FormLabel,\n              required: true,\n            }}\n            helperText={errors.feedback?.message || 'Max 200 characters'}\n            error={!!errors.feedback}\n            disabled={loading}\n          />\n        )}\n        <Grid container direction=\"row\" marginTop=\"16px\" spacing={1}>\n          <Grid item xs={6}>\n            <Button color=\"secondary\" disabled={loading} fullWidth onClick={handleClose}>\n              Cancel\n            </Button>\n          </Grid>\n          <Grid item xs={6}>\n            <LoadingButton disabled={!smileFieldValue} fullWidth loading={loading} type=\"submit\" variant=\"contained\">\n              Send Feedback\n            </LoadingButton>\n          </Grid>\n        </Grid>\n      </Grid>\n    );\n  } else {\n    return null;\n  }\n};\n","import { IconButton } from '@availity/mui-button';\nimport { CloseIcon } from '@availity/mui-icon';\nimport { Typography } from '@availity/mui-typography';\nimport { Grid } from '@mui/material';\n\ninterface FeedbackHeaderProps {\n  appName: string;\n  handleClose: () => void;\n  loading: boolean;\n  sent: boolean;\n}\n\nexport const FeedbackHeader = ({ appName, handleClose, loading, sent }: FeedbackHeaderProps): JSX.Element => {\n  return (\n    <Grid\n      alignItems=\"center\"\n      container\n      direction=\"row\"\n      marginBottom={!sent ? '8px' : '0px'}\n      justifyContent=\"space-between\"\n      flexWrap=\"nowrap\"\n      id=\"feedback-form-header\"\n    >\n      <Grid item whiteSpace=\"normal\">\n        <Typography component=\"h2\" variant=\"h5\">\n          {sent ? 'Thank you for your feedback.' : `Tell us what you think about ${appName}`}\n        </Typography>\n      </Grid>\n      <Grid item marginRight=\"-8px\">\n        <IconButton disabled={loading} title=\"Close\" onClick={handleClose}>\n          <CloseIcon />\n        </IconButton>\n      </Grid>\n    </Grid>\n  );\n};\n","import { useState } from 'react';\nimport { Popover } from '@availity/mui-popover';\nimport { Button } from '@availity/mui-button';\nimport { Container, styled } from '@mui/material';\nimport { avLogMessagesApi } from '@availity/api-axios';\nimport { FeedbackForm } from './FeedbackForm';\nimport { FeedbackHeader } from './FeedbackHeader';\n\nexport interface FeedbackProps {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  analytics?: { info: (entries: any) => any };\n  appName: string;\n}\n\nconst FeedbackContainer = styled(Container, { name: 'AvFeedbackContainer', slot: 'root' })({});\n\nexport const Feedback = ({ analytics = avLogMessagesApi, appName }: FeedbackProps): JSX.Element => {\n  const [anchorEl, setAnchorEl] = useState<HTMLElement | null>(null);\n  const [sent, setSent] = useState<boolean>(false);\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const handlePopoverOpen = (event: React.MouseEvent<HTMLElement>) => {\n    setAnchorEl(event.currentTarget);\n    setSent(false);\n  };\n\n  const handlePopoverClose = () => {\n    setAnchorEl(null);\n  };\n\n  const open = Boolean(anchorEl);\n\n  return (\n    <>\n      <Button onClick={handlePopoverOpen} color=\"secondary\" size=\"large\">\n        Give Feedback\n      </Button>\n      <Popover\n        anchorEl={anchorEl}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'right',\n        }}\n        sx={{ marginTop: '4px' }}\n        disableRestoreFocus\n        onClose={handlePopoverClose}\n        open={open}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'right',\n        }}\n      >\n        <FeedbackContainer>\n          <FeedbackHeader appName={appName} handleClose={handlePopoverClose} loading={loading} sent={sent} />\n          <FeedbackForm\n            analytics={analytics}\n            appName={appName}\n            handleClose={handlePopoverClose}\n            loading={loading}\n            sent={sent}\n            setLoading={setLoading}\n            setSent={setSent}\n          />\n        </FeedbackContainer>\n      </Popover>\n    </>\n  );\n};\n"],"names":["SmileButtons","styled","ToggleButtonGroup","SmileButton","disabled","Icon","label","value","props","jsx","ToggleButton","FeedbackForm","analytics","appName","handleClose","loading","sent","setLoading","setSent","control","errors","handleSubmit","register","setValue","watch","useForm","onSubmit","smileField","values","response","avRegionsApi","useEffect","options","FaceSmileIcon","FaceNeutralIcon","FaceFrownIcon","smileFieldValue","getFeedbackLabel","option","option2","jsxs","Grid","Controller","field","index","event","TextField","FormLabel","_a","Button","LoadingButton","FeedbackHeader","Typography","IconButton","CloseIcon","FeedbackContainer","Container","Feedback","avLogMessagesApi","anchorEl","setAnchorEl","useState","handlePopoverOpen","handlePopoverClose","Fragment","Popover"],"mappings":"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"}