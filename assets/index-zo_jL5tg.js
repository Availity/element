import{r as y}from"./index-BgYLq7fD.js";import{T as N}from"./index-BREKFP9Y.js";import{S as D,b as M}from"./index-YXU10wut.js";import{j as i}from"./jsx-runtime-BTJTZTIL.js";import{a as K,b as V,c as R}from"./index-Dl5t6TV_.js";import{q as G}from"./index-DLKRbc4C.js";import{A as W}from"./Autocomplete-Dm71EoBJ.js";import{u as B}from"./useInfiniteQuery-CLtpp7_P.js";import{I as H}from"./IconButton-BFylt634.js";import{C as Q}from"./CircularProgress-o1goEU37.js";var $=Object.defineProperty,J=Object.defineProperties,U=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,q=(e,r,t)=>r in e?$(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,a=(e,r)=>{for(var t in r||(r={}))w.call(r,t)&&q(e,t,r[t]);if(g)for(var t of g(r))A.call(r,t)&&q(e,t,r[t]);return e},d=(e,r)=>J(e,U(r)),I=(e,r)=>{var t={};for(var o in e)w.call(e,o)&&r.indexOf(o)<0&&(t[o]=e[o]);if(e!=null&&g)for(var o of g(e))r.indexOf(o)<0&&A.call(e,o)&&(t[o]=e[o]);return t},v=(e,r,t)=>new Promise((o,c)=>{var f=p=>{try{m(t.next(p))}catch(l){c(l)}},n=p=>{try{m(t.throw(p))}catch(l){c(l)}},m=p=>p.done?o(p.value):Promise.resolve(p.value).then(f,n);m((t=t.apply(e,r)).next())}),X=y.forwardRef((e,r)=>i.jsxs(i.Fragment,{children:[i.jsx(M,{orientation:"vertical",className:"MuiSelect-avEndAdornmentDivider"}),i.jsx(H,d(a({},e),{ref:r}))]})),Y={marginRight:".5rem"},Z=()=>i.jsx(Q,{"aria-label":"Loading",size:20,sx:Y}),k=e=>{var r=e,{FieldProps:t}=r,o=I(r,["FieldProps"]);const c={fullWidth:!0,size:"small"},f=n=>({InputProps:d(a(a({},n==null?void 0:n.InputProps),t==null?void 0:t.InputProps),{endAdornment:o.loading?i.jsxs(i.Fragment,{children:[(n==null?void 0:n.InputProps.endAdornment)||null,i.jsx(Z,{})]}):(n==null?void 0:n.InputProps.endAdornment)||null}),inputProps:d(a({},n==null?void 0:n.inputProps),{"aria-controls":(n==null?void 0:n.inputProps["aria-controls"])||""})});return i.jsx(W,a(a({renderInput:n=>i.jsx(N,a(a(a({},n),t),f(n))),popupIcon:i.jsx(D,{className:"MuiSelect-avExpandIcon"}),slotProps:{popupIndicator:{component:X}}},o),c))},ee=(e,r)=>{const[t,o]=y.useState("");return y.useEffect(()=>{const c=setTimeout(()=>{o(e)},r);return()=>{clearTimeout(c)}},[e]),t},re=e=>{var r=e,{loadOptions:t,limit:o=50,queryKey:c,ListboxProps:f,queryOptions:n,watchParams:m,debounceTimeout:p=350,FieldProps:l,onInputChange:P}=r,O=I(r,["loadOptions","limit","queryKey","ListboxProps","queryOptions","watchParams","debounceTimeout","FieldProps","onInputChange"]);const[_,b]=y.useState(""),S=s=>{var u;b(s.target.value),(u=l==null?void 0:l.InputProps)!=null&&u.onChange&&l.InputProps.onChange(s)},C=ee(_,p),{isLoading:F,isFetching:j,data:x,hasNextPage:L,fetchNextPage:T}=B(a({queryKey:[c,o,C,m],queryFn:s=>v(void 0,[s],function*({pageParam:u=0}){return t(u,o,C)}),staleTime:1e4,getNextPageParam:s=>s.hasMore?s.offset+o:void 0},n)),z=x!=null&&x.pages?x.pages.map(s=>s.options).flat():[],E=(s,u,h)=>{h==="clear"?b(s.target.value):h==="blur"&&b(u),P&&P(s,u,h)};return i.jsx(k,d(a({},O),{onInputChange:E,FieldProps:d(a({},l),{InputProps:d(a({},l==null?void 0:l.InputProps),{onChange:S})}),loading:j,options:z,ListboxProps:d(a({},f),{onScroll:s=>v(void 0,null,function*(){const u=s.currentTarget;u.scrollHeight-(u.scrollTop+u.clientHeight)<=5&&!F&&!j&&L&&T()})})}))},te=e=>v(void 0,null,function*(){const r=yield V.query(e);return{options:r.data.codes,hasMore:e.params.offset+e.params.limit<r.data.totalCount,offset:e.params.offset}}),oe=e=>[e.code,e.value].filter(Boolean).join(" - "),me=e=>{var r=e,{apiConfig:t={},queryOptions:o,queryKey:c="codes-autocomplete",list:f,watchParams:n}=r,m=I(r,["apiConfig","queryOptions","queryKey","list","watchParams"]);const p=(l,P,O)=>v(void 0,null,function*(){return yield te(d(a({},t),{params:d(a({},t.params),{list:f,offset:l,limit:P,q:O})}))});return i.jsx(re,d(a({getOptionLabel:oe,queryKey:c,queryOptions:a({enabled:!!f},o),watchParams:a({list:f},n)},m),{loadOptions:p}))},ve=e=>v(void 0,null,function*(){const r=d(a({},e),{paramsSerializer:{serialize:o=>G.stringify(o,{arrayFormat:"repeat"})}}),t=yield K.getOrganizations(r);return{options:t.data.organizations,hasMore:e.params.offset+e.params.limit<t.data.totalCount,offset:e.params.offset}}),Pe=e=>e.name,he=(e,r)=>v(void 0,null,function*(){const t=yield R.getProviders(e,r);return{options:t.data.providers,hasMore:r.params.offset+r.params.limit<t.data.totalCount,offset:r.params.offset}}),ye=e=>e.uiDisplayName;export{k as A,me as C,re as a,Pe as b,ve as c,ye as d,he as e,te as f,oe as h};
